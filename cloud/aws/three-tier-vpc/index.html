
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Gtz4All Reference Documentation">
      
      
      
      
        <link rel="canonical" href="https://gtz4all.github.io/cloud/aws/three-tier-vpc/">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.8">
    
    
      
        <title>Three Tier VPC Design - Gtz4All</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.cb6bc1d0.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.39b8e14a.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/extra.css">
    
    
      
    
    

  <!-- Determine title -->
  
  
    
  

  <!-- Open Graph Social Preview Card-->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Gtz4All - Three Tier VPC Design" />
  <meta property="og:description" content="Gtz4All Reference Documentation" />
  <meta property="og:url" content="https://gtz4all.github.io/cloud/aws/three-tier-vpc/" />
  <meta property="og:image" content="<url>" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="deep-purple">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#public-tier" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://gtz4all.github.io/" title="Gtz4All" class="md-header-nav__button md-logo" aria-label="Gtz4All">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 2l-5 4.5v11l5-4.5V2M6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Gtz4All
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Three Tier VPC Design
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        Home
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../introduction/" class="md-tabs__link md-tabs__link--active">
        Cloud
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../networking/introduction.md" class="md-tabs__link">
        Networking
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../devops/introduction.md" class="md-tabs__link">
        DevOps
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../contact-us/contribute/" class="md-tabs__link">
        Contact Us
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://gtz4all.github.io/" title="Gtz4All" class="md-nav__button md-logo" aria-label="Gtz4All">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 2l-5 4.5v11l5-4.5V2M6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5z"/></svg>

    </a>
    Gtz4All
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1" >
      
      <label class="md-nav__link" for="nav-1">
        Home
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Home" data-md-level="1">
        <label class="md-nav__title" for="nav-1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../welcome/" class="md-nav__link">
        Welcome
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/" class="md-nav__link">
        Cloud
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../networking/introduction.md" class="md-nav__link">
        Networking
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../license/" class="md-nav__link">
        License
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
      
      <label class="md-nav__link" for="nav-2">
        Cloud
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Cloud" data-md-level="1">
        <label class="md-nav__title" for="nav-2">
          <span class="md-nav__icon md-icon"></span>
          Cloud
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2" checked>
      
      <label class="md-nav__link" for="nav-2-2">
        AWS
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="AWS" data-md-level="2">
        <label class="md-nav__title" for="nav-2-2">
          <span class="md-nav__icon md-icon"></span>
          AWS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../default-vpc-cleanup/" class="md-nav__link">
        Default VPC Cleanup
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ec2-dynamic-dns/" class="md-nav__link">
        Route53 Dynamic DNS
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Three Tier VPC Design
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Three Tier VPC Design
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#public-tier" class="md-nav__link">
    Public Tier
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#private-tier" class="md-nav__link">
    Private Tier
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#local-tier" class="md-nav__link">
    Local Tier
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cloudformation" class="md-nav__link">
    Cloudformation
  </a>
  
    <nav class="md-nav" aria-label="Cloudformation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#componentes" class="md-nav__link">
    Componentes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#built-in-intrinsic-functions" class="md-nav__link">
    Built-in Intrinsic Functions
  </a>
  
    <nav class="md-nav" aria-label="Built-in Intrinsic Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fncidr-cidr" class="md-nav__link">
    Fn::Cidr ( !Cidr )
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fngetazs-getazs" class="md-nav__link">
    Fn::GetAZs (!GetAZs)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#three-tier-vpc-cloudformation-template" class="md-nav__link">
    Three Tier VPC Cloudformation Template
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3" >
      
      <label class="md-nav__link" for="nav-2-3">
        GCP
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="GCP" data-md-level="2">
        <label class="md-nav__title" for="nav-2-3">
          <span class="md-nav__icon md-icon"></span>
          GCP
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../gcp/introduction.md" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4" >
      
      <label class="md-nav__link" for="nav-2-4">
        Azure
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Azure" data-md-level="2">
        <label class="md-nav__title" for="nav-2-4">
          <span class="md-nav__icon md-icon"></span>
          Azure
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/introduction.md" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
      
      <label class="md-nav__link" for="nav-3">
        Networking
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Networking" data-md-level="1">
        <label class="md-nav__title" for="nav-3">
          <span class="md-nav__icon md-icon"></span>
          Networking
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../networking/introduction.md" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2" >
      
      <label class="md-nav__link" for="nav-3-2">
        Arista
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Arista" data-md-level="2">
        <label class="md-nav__title" for="nav-3-2">
          <span class="md-nav__icon md-icon"></span>
          Arista
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../networking/arista/introduction.md" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3" >
      
      <label class="md-nav__link" for="nav-3-3">
        Cisco
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Cisco" data-md-level="2">
        <label class="md-nav__title" for="nav-3-3">
          <span class="md-nav__icon md-icon"></span>
          Cisco
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../networking/cisco/introduction.md" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
      
      <label class="md-nav__link" for="nav-4">
        DevOps
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DevOps" data-md-level="1">
        <label class="md-nav__title" for="nav-4">
          <span class="md-nav__icon md-icon"></span>
          DevOps
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/introduction.md" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2" >
      
      <label class="md-nav__link" for="nav-4-2">
        Terraform
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Terraform" data-md-level="2">
        <label class="md-nav__title" for="nav-4-2">
          <span class="md-nav__icon md-icon"></span>
          Terraform
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/terraform/introduction.md" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3" >
      
      <label class="md-nav__link" for="nav-4-3">
        Ansible
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Ansible" data-md-level="2">
        <label class="md-nav__title" for="nav-4-3">
          <span class="md-nav__icon md-icon"></span>
          Ansible
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/ansible/introduction.md" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4" >
      
      <label class="md-nav__link" for="nav-4-4">
        Python
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Python" data-md-level="2">
        <label class="md-nav__title" for="nav-4-4">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/python/introduction.md" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" >
      
      <label class="md-nav__link" for="nav-5">
        Contact Us
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Contact Us" data-md-level="1">
        <label class="md-nav__title" for="nav-5">
          <span class="md-nav__icon md-icon"></span>
          Contact Us
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../contact-us/contribute/" class="md-nav__link">
        Contribute
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../contact-us/faqs.md" class="md-nav__link">
        FAQs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../contact-us/contact-me/" class="md-nav__link">
        Contact Us
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#public-tier" class="md-nav__link">
    Public Tier
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#private-tier" class="md-nav__link">
    Private Tier
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#local-tier" class="md-nav__link">
    Local Tier
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cloudformation" class="md-nav__link">
    Cloudformation
  </a>
  
    <nav class="md-nav" aria-label="Cloudformation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#componentes" class="md-nav__link">
    Componentes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#built-in-intrinsic-functions" class="md-nav__link">
    Built-in Intrinsic Functions
  </a>
  
    <nav class="md-nav" aria-label="Built-in Intrinsic Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fncidr-cidr" class="md-nav__link">
    Fn::Cidr ( !Cidr )
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fngetazs-getazs" class="md-nav__link">
    Fn::GetAZs (!GetAZs)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#three-tier-vpc-cloudformation-template" class="md-nav__link">
    Three Tier VPC Cloudformation Template
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Three Tier VPC Design</h1>
                
                <p>An AWS Three-Tier VPC Design provides a baseline to deploy software applications that consist of frontend, backend and database.This design provides Availability Zone High Availability and Fault Tolerant. In addition this design also provides the required topoligy for a highly secured environment.</p>
<p><img alt="three-tier-vpc-design.jpeg" src="../images/three-tier-vpc-design.jpeg" /></p>
<h4 id="public-tier">Public Tier<a class="headerlink" href="#public-tier" title="Permanent link">&para;</a></h4>
<p>The Public Tier has both inbound/outbound VPC External access. It is used to provide external services and an entry point into the environment</p>
<p><strong><em>Recommended Resources</em></strong>:
* Public Application Load Balancer
    Users will only be allowed to access application via public Application Load Balancer
* NAT Gateways
    Provides outbound access for private tier. This is required for software updates or patches
* Bastion Hosts
    A bastion host provides secure management access into all three tiers. These servers should be secured with MFA. </p>
<h4 id="private-tier">Private Tier<a class="headerlink" href="#private-tier" title="Permanent link">&para;</a></h4>
<p>The Private Tier only has outbound VPC External Access which is mainly used for software patches and updates. This is where the application servers and internal load balancer reside.</p>
<p><strong><em>Recommended Resources</em></strong>:
* Internal Application Load Balancer
    This type of ALBs and NLBs are used to provide a Highly Available Service to the Public Tier ALBs
* Application Servers
    EC2s, Lambda or EKS, ECS</p>
<h4 id="local-tier">Local Tier<a class="headerlink" href="#local-tier" title="Permanent link">&para;</a></h4>
<p>This tier does not have inbound/outbould VPC External Access. It is meant to host database services. Services inside this tier should only be access by the application services. </p>
<p><strong><em>Recommended Resources</em></strong>:
* Database Instances</p>
<h2 id="cloudformation">Cloudformation<a class="headerlink" href="#cloudformation" title="Permanent link">&para;</a></h2>
<p>Cloudformation is a tool to quickly and consistently deploy infrastructure by building the designed resources and managing them as stacks. it is a declarative programming language with some basic features specific to this use case.</p>
<h4 id="componentes">Componentes<a class="headerlink" href="#componentes" title="Permanent link">&para;</a></h4>
<ul>
<li>Metadata: </li>
</ul>
<p><code>AWS::CloudFormation::Interface</code> is used to modify how the AWS Cloudformation groups, labels and orders user input parameters.
  <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/metadata-section-structure.html">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/metadata-section-structure.html</a> 
  <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nt">Metadata</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="l l-Scalar l-Scalar-Plain">AWS::CloudFormation::Interface</span><span class="p p-Indicator">:</span><span class="w"> </span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">  </span><span class="nt">ParameterGroups</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Label</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">        </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Availability</span><span class="nv"> </span><span class="s">Zones&quot;</span><span class="w"></span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">      </span><span class="nt">Parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NumberOfAZs</span><span class="w"></span>
</code></pre></div>
* Parametes:</p>
<p>Parameters are used to request user input custom values which are later used by the <code>Resources</code> section to build infrastructure.
  <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/parameters-section-structure.html">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/parameters-section-structure.html</a>
  <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nt">Parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">  </span><span class="nt">NumberOfAZs</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Number</span><span class="w"></span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="nt">AllowedValues</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class="w"></span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span><span class="w"></span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">    </span><span class="nt">Default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class="w"></span>
</code></pre></div></p>
<ul>
<li>Conditions:</li>
</ul>
<p>Conditions are used to set parameters based on other parameter's values provided by the user. These conditions are later used to set conditial resources. ex: If <code>Condition: Value</code> is true, create resource.
  <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/conditions-section-structure.html">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/conditions-section-structure.html</a>
  <div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1">## Conditions are either True or False and are used to choose whether a rosource should be created or not. </span><span class="w"></span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="nt">Conditions</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">  </span><span class="c1">## Build4AZs is True if NumberofAZs is set to &#39;4&#39;</span><span class="w"></span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">  </span><span class="nt">Build4AZs</span><span class="p">:</span><span class="w">    </span><span class="kt">!Equals</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">NumberOfAZs</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">4</span><span class="w"> </span><span class="p p-Indicator">]</span><span class="w"> </span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">  </span><span class="c1">## Build4AZs is True if NumberofAZs is set to &#39;4&#39;</span><span class="w"></span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">  </span><span class="nt">ProdVPC</span><span class="p">:</span><span class="w">    </span><span class="kt">!Equals</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">Environment</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">prod</span><span class="w"> </span><span class="p p-Indicator">]</span><span class="w"> </span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">  </span><span class="c1">## BuildProdEnvironemt is True if both Build4AZs and ProdVPC are True</span><span class="w"></span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="w">  </span><span class="nt">BuildProdEnvironemt</span><span class="p">:</span><span class="w">   </span><span class="kt">!And</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Condition</span><span class="w"> </span><span class="nv">Build4AZs</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Condition</span><span class="w"> </span><span class="nv">ProdVPC</span><span class="w"> </span><span class="p p-Indicator">]</span><span class="w"></span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="nt">Resources</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="w">  </span><span class="nt">PublicSubnet3</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::Subnet</span><span class="w"></span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="w">    </span><span class="c1">## PublicSubnet3 will be created only if Build4AZs is True</span><span class="w"></span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="w">    </span><span class="nt">Condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build4AZs</span><span class="w"></span>
</code></pre></div></p>
<h4 id="built-in-intrinsic-functions">Built-in Intrinsic Functions<a class="headerlink" href="#built-in-intrinsic-functions" title="Permanent link">&para;</a></h4>
<p>An intrinsic function used to perform a mathematical, character, or logical operation against a data item whose value is derived automatically during execution.</p>
<h6 id="fncidr-cidr">Fn::Cidr ( !Cidr )<a class="headerlink" href="#fncidr-cidr" title="Permanent link">&para;</a></h6>
<p>This Subnetting calculator function returns an CIDR address block list based on the <code>`count</code> provided. </p>
<p><code>!Cidr [ ipBlock, count, cidrBits ]</code></p>
<ul>
<li>
<p><strong><em>Parameters</em></strong></p>
<ul>
<li><code>ipBlock</code>: CIDR address block to be split into smaller CIDR blocks.</li>
<li><code>count</code>: The number of smaller CIDRs blocks to generate. Valid range 1 - 256.</li>
<li><code>cidrBits</code>: The number of subnet bits for the CIDR. </li>
</ul>
</li>
<li>
<p><strong><em>Example</em></strong></p>
<ul>
<li>Requirementes: create 12(count) /24s(cidrBits) out of a /16 (ipBlock) and pick the 6<sup>th</sup>(!Select) CIDR block.</li>
</ul>
</li>
</ul>
<table>
<tr>
<th>!Select [ 5, !Cidr [ "10.10.0.0/16", 12, 5 ]</th>
<th>Generated Table</th>
</tr>
<tr>
<td>

  - !Select - select the 6th block - starts from 0 - 7 if there are 8 blocks.

    ```!Select [ 5,``` 
  - !Cidr [CidrBlock = (/16),  12 = break /16 into 12 block, what size for each block? look at host-bits...

    ```!Cidr [ "10.10.0.0/16", 12,```
  - SubnetBits/cidrBits = 8 - which means host-bits of 8, (/24s)

    ```8]]```

***cidrBit Table***

Suffix|IPs|CIDR|Borrowed Bits|Binary
-|-|-|-|-
.255|1  |/32|0|11111111 
.254|2  |/31|1|11111110
.252|4  |/30|2|11111100
.248|8  |/29|3|11111000
.240|16 |/28|4|11110000
.224|32 |/27|5|11100000
.192|64 |/26|6|11000000
.128|128|/25|7|10000000
.0|256|/24|8|00000000

</td>
<td>    

Count|CidrBlocks|Select
-|-|-
0|10.10.0.0/24| 
1|10.10.1.0/24| 
2|10.10.2.0/24| 
3|10.10.3.0/24| 
4|10.10.4.0/24| 
5|10.10.5.0/24|!Select
6|10.10.6.0/24| 
7|10.10.7.0/24| 
8|10.10.8.0/24| 
9|10.10.9.0/24| 
10|10.10.10.0/24|
11|10.10.11.0/24|
12|10.10.12.0/24| 

</td>
</tr>
</table>

<ul>
<li><strong><em>Conditional Subnetting</em></strong>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!If</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">BuildProd</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="kt">!Cidr</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">CidrBlock</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!If</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">BuildProd</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">16</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">8</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="kt">!If</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">BuildProd</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">5</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">6</span><span class="p p-Indicator">]]]</span><span class="w"></span>
</code></pre></div></li>
</ul>
<table>
<tr>
<th>Conditial !Cidr</th>
<th>Condition !if</th>
</tr>
<tr>
<td>

  - if BuildPord is True - Create 16 /27s (Host-Bits - 5 ) blocks
  - if BuildPord is False - Create 8 /26s (Host-Bits - 6 ) blocks 

    <div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!If</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">BuildProd</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0</span><span class="p p-Indicator">],</span><span class="w"> </span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="kt">!Cidr</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">CidrBlock</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!If</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">BuildProd</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">16</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">8</span><span class="p p-Indicator">],</span><span class="w"> </span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="kt">!If</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">BuildProd</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">5</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">6</span><span class="p p-Indicator">]]]</span><span class="w"></span>
</code></pre></div>

</td>
<td>

  !If Condition|Boolean|Value
  -|-|-
  BluidProd|True|firstValue
  BluidProd|False|secondValue

  ***!Cidr*** 

  ipBlock|count|cidrBits
  -|-|-
  !Ref CidrBlock|!If [BuildProd, 16, 8]|!If [BuildProd, 5, 6]

</td>
</tr>
</table>

<h6 id="fngetazs-getazs">Fn::GetAZs (!GetAZs)<a class="headerlink" href="#fngetazs-getazs" title="Permanent link">&para;</a></h6>
<p>The intrinsic function Fn::GetAZs returns a Availability Zone Name List based for a region. </p>
<p>{{% notice note %}}
AZ Name to AZ ID mapping is different per account.
{{% /notice %}}</p>
<ul>
<li><code>!GetAZs ""</code> in <code>us-east-1</code> returns a list of all Availability Zones: <code>[ "us-east-1a", "us-east-1b", "us-east-1c", "us-east-1d", "us-east-1e", "us-east-1f" ]</code> </li>
</ul>
<table>
<thead>
<tr>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
</tr>
</thead>
<tbody>
<tr>
<td>"us-east-1a"</td>
<td>"us-east-1b"</td>
<td>"us-east-1c"</td>
<td>"us-east-1d"</td>
<td>"us-east-1e"</td>
<td>"us-east-1f"</td>
</tr>
</tbody>
</table>
<ul>
<li><code>!Select</code> can pick an AZ based on the order list. </li>
</ul>
<p><code>!Select [3, !GetAZs '']</code> returns  <code>"us-east-1d"</code>.</p>
<h4 id="three-tier-vpc-cloudformation-template">Three Tier VPC Cloudformation Template<a class="headerlink" href="#three-tier-vpc-cloudformation-template" title="Permanent link">&para;</a></h4>
<p>This template builds the Three Tier VPC based on the above topology using the built-in cloudformation functions recently mentioned. </p>
<p><a href="../gtz4all-three-tier-vpc.yml">Gtz4all Three Tier VPC Template</a></p>
<div style="width:1200px;height:600px;overflow:auto;">

<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nt">AWSTemplateFormatVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2010-09-09</span><span class="w"></span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="nt">Description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GTZ Three Tier VPC Template</span><span class="w"></span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="nt">Metadata</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">AWS::CloudFormation::Interface</span><span class="p p-Indicator">:</span><span class="w"> </span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">    </span><span class="nt">ParameterGroups</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Label</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">          </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Stack</span><span class="nv"> </span><span class="s">Name</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">{{ProjectName}}-{{Environment}}-three-tier-vpc-cf</span><span class="nv"> </span><span class="s">(i.e</span><span class="nv"> </span><span class="s">jira-dev-three-tier-vpc-cf)&quot;</span><span class="w"></span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Label</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">          </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;|&quot;</span><span class="w"></span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Label</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">          </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;VPC</span><span class="nv"> </span><span class="s">Configuration&quot;</span><span class="w"></span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="w">        </span><span class="nt">Parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ProjectName</span><span class="w"></span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Environment</span><span class="w">          </span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CidrBlock</span><span class="w"></span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Label</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="w">          </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Subnet</span><span class="nv"> </span><span class="s">8</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">/24(/20</span><span class="nv"> </span><span class="s">CidrBlock</span><span class="nv"> </span><span class="s">Required),</span><span class="nv"> </span><span class="s">7</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">/25</span><span class="nv"> </span><span class="s">(/21</span><span class="nv"> </span><span class="s">CidrBlock</span><span class="nv"> </span><span class="s">Required),</span><span class="nv"> </span><span class="s">6</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">/26</span><span class="nv"> </span><span class="s">(/22</span><span class="nv"> </span><span class="s">CidrBlock</span><span class="nv"> </span><span class="s">Required)&quot;</span><span class="w"></span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="w">        </span><span class="nt">Parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SubnetBits</span><span class="w"></span>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Label</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a><span class="w">          </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Availability</span><span class="nv"> </span><span class="s">Zones&quot;</span><span class="w"></span>
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a><span class="w">        </span><span class="nt">Parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NumberOfAZs</span><span class="w"></span>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a>
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a><span class="nt">Parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a><span class="w">  </span><span class="nt">ProjectName</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a><span class="w">    </span><span class="nt">Description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Project Name ( ex. jira /  sfpt / sec )</span><span class="w"></span>
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">String</span><span class="w"></span>
<a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a>
<a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a><span class="w">  </span><span class="nt">CidrBlock</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a><span class="w">    </span><span class="nt">AllowedPattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\/(1[6-9]|2[0-8]))$</span><span class="w"></span>
<a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a><span class="w">    </span><span class="nt">ConstraintDescription</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CIDR block parameter must be in the form x.x.x.x/16-28</span><span class="w"></span>
<a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a><span class="w">    </span><span class="nt">Description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC valid IP CIDR Blocks /20&#39;s, /21&#39;s and /22&#39;s( ex. 10.168.0.0/20)</span><span class="w"></span>
<a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a><span class="w">    </span><span class="nt">Default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.168.0.0/20</span><span class="w"></span>
<a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">String</span><span class="w"></span>
<a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a>
<a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a><span class="w">  </span><span class="nt">SubnetBits</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Number</span><span class="w"></span>
<a id="__codelineno-5-40" name="__codelineno-5-40" href="#__codelineno-5-40"></a><span class="w">    </span><span class="nt">AllowedValues</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-41" name="__codelineno-5-41" href="#__codelineno-5-41"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span><span class="w"></span>
<a id="__codelineno-5-42" name="__codelineno-5-42" href="#__codelineno-5-42"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7</span><span class="w"></span>
<a id="__codelineno-5-43" name="__codelineno-5-43" href="#__codelineno-5-43"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6</span><span class="w"></span>
<a id="__codelineno-5-44" name="__codelineno-5-44" href="#__codelineno-5-44"></a><span class="w">    </span><span class="nt">Default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span><span class="w"></span>
<a id="__codelineno-5-45" name="__codelineno-5-45" href="#__codelineno-5-45"></a><span class="w">    </span><span class="nt">Description</span><span class="p">:</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">Subnet Bits 8 = /24(/20 CidrBlock Required), 7 = /25 (/21 CidrBlock Required), 6 = /26 (/22 CidrBlock Required)</span><span class="w"></span>
<a id="__codelineno-5-46" name="__codelineno-5-46" href="#__codelineno-5-46"></a>
<a id="__codelineno-5-47" name="__codelineno-5-47" href="#__codelineno-5-47"></a><span class="w">  </span><span class="nt">NumberOfAZs</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-48" name="__codelineno-5-48" href="#__codelineno-5-48"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Number</span><span class="w"></span>
<a id="__codelineno-5-49" name="__codelineno-5-49" href="#__codelineno-5-49"></a><span class="w">    </span><span class="nt">AllowedValues</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-50" name="__codelineno-5-50" href="#__codelineno-5-50"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class="w"></span>
<a id="__codelineno-5-51" name="__codelineno-5-51" href="#__codelineno-5-51"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span><span class="w"></span>
<a id="__codelineno-5-52" name="__codelineno-5-52" href="#__codelineno-5-52"></a><span class="w">    </span><span class="nt">Default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class="w"></span>
<a id="__codelineno-5-53" name="__codelineno-5-53" href="#__codelineno-5-53"></a><span class="w">    </span><span class="nt">Description</span><span class="p">:</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">Availability Zones - 2 = 2 per Tier, 4 = 4 per Tier</span><span class="w"></span>
<a id="__codelineno-5-54" name="__codelineno-5-54" href="#__codelineno-5-54"></a>
<a id="__codelineno-5-55" name="__codelineno-5-55" href="#__codelineno-5-55"></a><span class="w">  </span><span class="nt">Environment</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-56" name="__codelineno-5-56" href="#__codelineno-5-56"></a><span class="w">    </span><span class="nt">Description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Choose VPC Type</span><span class="w"> </span>
<a id="__codelineno-5-57" name="__codelineno-5-57" href="#__codelineno-5-57"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">String</span><span class="w"></span>
<a id="__codelineno-5-58" name="__codelineno-5-58" href="#__codelineno-5-58"></a><span class="w">    </span><span class="nt">AllowedValues</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-59" name="__codelineno-5-59" href="#__codelineno-5-59"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dev</span><span class="w"></span>
<a id="__codelineno-5-60" name="__codelineno-5-60" href="#__codelineno-5-60"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test</span><span class="w"></span>
<a id="__codelineno-5-61" name="__codelineno-5-61" href="#__codelineno-5-61"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prod</span><span class="w"></span>
<a id="__codelineno-5-62" name="__codelineno-5-62" href="#__codelineno-5-62"></a>
<a id="__codelineno-5-63" name="__codelineno-5-63" href="#__codelineno-5-63"></a><span class="nt">Conditions</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-64" name="__codelineno-5-64" href="#__codelineno-5-64"></a><span class="w">  </span><span class="nt">Build4AZs</span><span class="p">:</span><span class="w">    </span><span class="kt">!Equals</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">NumberOfAZs</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">4</span><span class="w"> </span><span class="p p-Indicator">]</span><span class="w"> </span>
<a id="__codelineno-5-65" name="__codelineno-5-65" href="#__codelineno-5-65"></a>
<a id="__codelineno-5-66" name="__codelineno-5-66" href="#__codelineno-5-66"></a><span class="c1">###############################################</span><span class="w"></span>
<a id="__codelineno-5-67" name="__codelineno-5-67" href="#__codelineno-5-67"></a><span class="c1">### Three Tier VPC                         ####</span><span class="w"></span>
<a id="__codelineno-5-68" name="__codelineno-5-68" href="#__codelineno-5-68"></a><span class="c1">###############################################  </span><span class="w"></span>
<a id="__codelineno-5-69" name="__codelineno-5-69" href="#__codelineno-5-69"></a><span class="nt">Resources</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-70" name="__codelineno-5-70" href="#__codelineno-5-70"></a><span class="w">  </span><span class="nt">VPC</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-71" name="__codelineno-5-71" href="#__codelineno-5-71"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::VPC</span><span class="w"></span>
<a id="__codelineno-5-72" name="__codelineno-5-72" href="#__codelineno-5-72"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-73" name="__codelineno-5-73" href="#__codelineno-5-73"></a><span class="w">      </span><span class="nt">CidrBlock</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">Ref</span><span class="p">:</span><span class="w"> </span><span class="nv">CidrBlock</span><span class="p p-Indicator">}</span><span class="w"></span>
<a id="__codelineno-5-74" name="__codelineno-5-74" href="#__codelineno-5-74"></a><span class="w">      </span><span class="nt">EnableDnsHostnames</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<a id="__codelineno-5-75" name="__codelineno-5-75" href="#__codelineno-5-75"></a><span class="w">      </span><span class="nt">EnableDnsSupport</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<a id="__codelineno-5-76" name="__codelineno-5-76" href="#__codelineno-5-76"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-77" name="__codelineno-5-77" href="#__codelineno-5-77"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-78" name="__codelineno-5-78" href="#__codelineno-5-78"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">Environment</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;three-tier&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;vpc&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-79" name="__codelineno-5-79" href="#__codelineno-5-79"></a>
<a id="__codelineno-5-80" name="__codelineno-5-80" href="#__codelineno-5-80"></a><span class="w">  </span><span class="nt">DhcpOptions</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-81" name="__codelineno-5-81" href="#__codelineno-5-81"></a><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::DHCPOptions</span><span class="w"></span>
<a id="__codelineno-5-82" name="__codelineno-5-82" href="#__codelineno-5-82"></a><span class="w">      </span><span class="nt">Properties</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-83" name="__codelineno-5-83" href="#__codelineno-5-83"></a><span class="w">          </span><span class="nt">DomainName</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;three-tier.org&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-84" name="__codelineno-5-84" href="#__codelineno-5-84"></a><span class="w">          </span><span class="nt">DomainNameServers</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-85" name="__codelineno-5-85" href="#__codelineno-5-85"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AmazonProvidedDNS</span><span class="w"></span>
<a id="__codelineno-5-86" name="__codelineno-5-86" href="#__codelineno-5-86"></a><span class="w">          </span><span class="nt">Tags</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-87" name="__codelineno-5-87" href="#__codelineno-5-87"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-88" name="__codelineno-5-88" href="#__codelineno-5-88"></a><span class="w">              </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">Environment</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;three-tier&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;dopt&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-89" name="__codelineno-5-89" href="#__codelineno-5-89"></a>
<a id="__codelineno-5-90" name="__codelineno-5-90" href="#__codelineno-5-90"></a><span class="w">  </span><span class="nt">VPCDHCPOptionsAssociation</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-91" name="__codelineno-5-91" href="#__codelineno-5-91"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::VPCDHCPOptionsAssociation</span><span class="w"></span>
<a id="__codelineno-5-92" name="__codelineno-5-92" href="#__codelineno-5-92"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-93" name="__codelineno-5-93" href="#__codelineno-5-93"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">Ref</span><span class="p">:</span><span class="w"> </span><span class="nv">VPC</span><span class="p p-Indicator">}</span><span class="w"></span>
<a id="__codelineno-5-94" name="__codelineno-5-94" href="#__codelineno-5-94"></a><span class="w">      </span><span class="nt">DhcpOptionsId</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">Ref</span><span class="p">:</span><span class="w"> </span><span class="nv">DhcpOptions</span><span class="p p-Indicator">}</span><span class="w"></span>
<a id="__codelineno-5-95" name="__codelineno-5-95" href="#__codelineno-5-95"></a>
<a id="__codelineno-5-96" name="__codelineno-5-96" href="#__codelineno-5-96"></a><span class="w">  </span><span class="nt">InternetGateway</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-97" name="__codelineno-5-97" href="#__codelineno-5-97"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::InternetGateway</span><span class="w"></span>
<a id="__codelineno-5-98" name="__codelineno-5-98" href="#__codelineno-5-98"></a><span class="w">    </span><span class="nt">DependsOn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-5-99" name="__codelineno-5-99" href="#__codelineno-5-99"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-100" name="__codelineno-5-100" href="#__codelineno-5-100"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-101" name="__codelineno-5-101" href="#__codelineno-5-101"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-102" name="__codelineno-5-102" href="#__codelineno-5-102"></a><span class="w">        </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">Environment</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;three-tier&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;igw&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-103" name="__codelineno-5-103" href="#__codelineno-5-103"></a><span class="w">  </span><span class="nt">VPCGatewayAttachment</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-104" name="__codelineno-5-104" href="#__codelineno-5-104"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::VPCGatewayAttachment</span><span class="w"></span>
<a id="__codelineno-5-105" name="__codelineno-5-105" href="#__codelineno-5-105"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-106" name="__codelineno-5-106" href="#__codelineno-5-106"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-5-107" name="__codelineno-5-107" href="#__codelineno-5-107"></a><span class="w">      </span><span class="nt">InternetGatewayId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">InternetGateway</span><span class="w"></span>
<a id="__codelineno-5-108" name="__codelineno-5-108" href="#__codelineno-5-108"></a>
<a id="__codelineno-5-109" name="__codelineno-5-109" href="#__codelineno-5-109"></a><span class="c1">###############################################</span><span class="w"></span>
<a id="__codelineno-5-110" name="__codelineno-5-110" href="#__codelineno-5-110"></a><span class="c1">### Public/ALB Tier (inbound/outbound)     ####</span><span class="w"></span>
<a id="__codelineno-5-111" name="__codelineno-5-111" href="#__codelineno-5-111"></a><span class="c1">############################################### </span><span class="w"></span>
<a id="__codelineno-5-112" name="__codelineno-5-112" href="#__codelineno-5-112"></a><span class="w">  </span><span class="nt">PublicRouteTableA</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-113" name="__codelineno-5-113" href="#__codelineno-5-113"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::RouteTable</span><span class="w"></span>
<a id="__codelineno-5-114" name="__codelineno-5-114" href="#__codelineno-5-114"></a><span class="w">    </span><span class="nt">DependsOn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPCGatewayAttachment</span><span class="w"></span>
<a id="__codelineno-5-115" name="__codelineno-5-115" href="#__codelineno-5-115"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-116" name="__codelineno-5-116" href="#__codelineno-5-116"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-117" name="__codelineno-5-117" href="#__codelineno-5-117"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-118" name="__codelineno-5-118" href="#__codelineno-5-118"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;public&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;rt-1a&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-119" name="__codelineno-5-119" href="#__codelineno-5-119"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-5-120" name="__codelineno-5-120" href="#__codelineno-5-120"></a><span class="w">  </span><span class="nt">PublicRouteTableB</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-121" name="__codelineno-5-121" href="#__codelineno-5-121"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::RouteTable</span><span class="w"></span>
<a id="__codelineno-5-122" name="__codelineno-5-122" href="#__codelineno-5-122"></a><span class="w">    </span><span class="nt">DependsOn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPCGatewayAttachment</span><span class="w"></span>
<a id="__codelineno-5-123" name="__codelineno-5-123" href="#__codelineno-5-123"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-124" name="__codelineno-5-124" href="#__codelineno-5-124"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-125" name="__codelineno-5-125" href="#__codelineno-5-125"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-126" name="__codelineno-5-126" href="#__codelineno-5-126"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;public&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;rt-1b&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-127" name="__codelineno-5-127" href="#__codelineno-5-127"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w">       </span>
<a id="__codelineno-5-128" name="__codelineno-5-128" href="#__codelineno-5-128"></a><span class="c1">###############################################</span><span class="w"></span>
<a id="__codelineno-5-129" name="__codelineno-5-129" href="#__codelineno-5-129"></a><span class="w">  </span><span class="nt">PublicSubnet1</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-130" name="__codelineno-5-130" href="#__codelineno-5-130"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::Subnet</span><span class="w"></span>
<a id="__codelineno-5-131" name="__codelineno-5-131" href="#__codelineno-5-131"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-132" name="__codelineno-5-132" href="#__codelineno-5-132"></a><span class="w">      </span><span class="nt">AvailabilityZone</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!GetAZs</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="p p-Indicator">]</span><span class="w"></span>
<a id="__codelineno-5-133" name="__codelineno-5-133" href="#__codelineno-5-133"></a><span class="w">      </span><span class="nt">CidrBlock</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Cidr</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">CidrBlock</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">SubnetBits</span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-134" name="__codelineno-5-134" href="#__codelineno-5-134"></a><span class="w">      </span><span class="nt">MapPublicIpOnLaunch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<a id="__codelineno-5-135" name="__codelineno-5-135" href="#__codelineno-5-135"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-136" name="__codelineno-5-136" href="#__codelineno-5-136"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-137" name="__codelineno-5-137" href="#__codelineno-5-137"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;public&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;subnet-1a&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-138" name="__codelineno-5-138" href="#__codelineno-5-138"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-5-139" name="__codelineno-5-139" href="#__codelineno-5-139"></a><span class="w">  </span><span class="nt">PublicSubnet2</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-140" name="__codelineno-5-140" href="#__codelineno-5-140"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::Subnet</span><span class="w"></span>
<a id="__codelineno-5-141" name="__codelineno-5-141" href="#__codelineno-5-141"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-142" name="__codelineno-5-142" href="#__codelineno-5-142"></a><span class="w">      </span><span class="nt">AvailabilityZone</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!GetAZs</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="p p-Indicator">]</span><span class="w">     </span>
<a id="__codelineno-5-143" name="__codelineno-5-143" href="#__codelineno-5-143"></a><span class="w">      </span><span class="nt">CidrBlock</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Cidr</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">CidrBlock</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">SubnetBits</span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-144" name="__codelineno-5-144" href="#__codelineno-5-144"></a><span class="w">      </span><span class="nt">MapPublicIpOnLaunch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<a id="__codelineno-5-145" name="__codelineno-5-145" href="#__codelineno-5-145"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-146" name="__codelineno-5-146" href="#__codelineno-5-146"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-147" name="__codelineno-5-147" href="#__codelineno-5-147"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;public&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;subnet-1b&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-148" name="__codelineno-5-148" href="#__codelineno-5-148"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-5-149" name="__codelineno-5-149" href="#__codelineno-5-149"></a><span class="w">  </span><span class="nt">PublicSubnet3</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-150" name="__codelineno-5-150" href="#__codelineno-5-150"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::Subnet</span><span class="w"></span>
<a id="__codelineno-5-151" name="__codelineno-5-151" href="#__codelineno-5-151"></a><span class="w">    </span><span class="nt">Condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build4AZs</span><span class="w"></span>
<a id="__codelineno-5-152" name="__codelineno-5-152" href="#__codelineno-5-152"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-153" name="__codelineno-5-153" href="#__codelineno-5-153"></a><span class="w">      </span><span class="nt">AvailabilityZone</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!GetAZs</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="p p-Indicator">]</span><span class="w"></span>
<a id="__codelineno-5-154" name="__codelineno-5-154" href="#__codelineno-5-154"></a><span class="w">      </span><span class="nt">CidrBlock</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Cidr</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">CidrBlock</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">SubnetBits</span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-155" name="__codelineno-5-155" href="#__codelineno-5-155"></a><span class="w">      </span><span class="nt">MapPublicIpOnLaunch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<a id="__codelineno-5-156" name="__codelineno-5-156" href="#__codelineno-5-156"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-157" name="__codelineno-5-157" href="#__codelineno-5-157"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-158" name="__codelineno-5-158" href="#__codelineno-5-158"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;public&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;subnet-1c&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-159" name="__codelineno-5-159" href="#__codelineno-5-159"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-5-160" name="__codelineno-5-160" href="#__codelineno-5-160"></a><span class="w">  </span><span class="nt">PublicSubnet4</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-161" name="__codelineno-5-161" href="#__codelineno-5-161"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::Subnet</span><span class="w"></span>
<a id="__codelineno-5-162" name="__codelineno-5-162" href="#__codelineno-5-162"></a><span class="w">    </span><span class="nt">Condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build4AZs</span><span class="w"></span>
<a id="__codelineno-5-163" name="__codelineno-5-163" href="#__codelineno-5-163"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-164" name="__codelineno-5-164" href="#__codelineno-5-164"></a><span class="w">      </span><span class="nt">AvailabilityZone</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!GetAZs</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="p p-Indicator">]</span><span class="w">     </span>
<a id="__codelineno-5-165" name="__codelineno-5-165" href="#__codelineno-5-165"></a><span class="w">      </span><span class="nt">CidrBlock</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Cidr</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">CidrBlock</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">SubnetBits</span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-166" name="__codelineno-5-166" href="#__codelineno-5-166"></a><span class="w">      </span><span class="nt">MapPublicIpOnLaunch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<a id="__codelineno-5-167" name="__codelineno-5-167" href="#__codelineno-5-167"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-168" name="__codelineno-5-168" href="#__codelineno-5-168"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-169" name="__codelineno-5-169" href="#__codelineno-5-169"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;public&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;subnet-1d&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-170" name="__codelineno-5-170" href="#__codelineno-5-170"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-5-171" name="__codelineno-5-171" href="#__codelineno-5-171"></a><span class="c1">###############################################</span><span class="w"></span>
<a id="__codelineno-5-172" name="__codelineno-5-172" href="#__codelineno-5-172"></a><span class="w">  </span><span class="nt">PublicSubnetAssoc1</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-173" name="__codelineno-5-173" href="#__codelineno-5-173"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::SubnetRouteTableAssociation</span><span class="w"></span>
<a id="__codelineno-5-174" name="__codelineno-5-174" href="#__codelineno-5-174"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-175" name="__codelineno-5-175" href="#__codelineno-5-175"></a><span class="w">      </span><span class="nt">RouteTableId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PublicRouteTableA</span><span class="w"></span>
<a id="__codelineno-5-176" name="__codelineno-5-176" href="#__codelineno-5-176"></a><span class="w">      </span><span class="nt">SubnetId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PublicSubnet1</span><span class="w"></span>
<a id="__codelineno-5-177" name="__codelineno-5-177" href="#__codelineno-5-177"></a><span class="w">  </span><span class="nt">PublicSubnetAssoc2</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-178" name="__codelineno-5-178" href="#__codelineno-5-178"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::SubnetRouteTableAssociation</span><span class="w"></span>
<a id="__codelineno-5-179" name="__codelineno-5-179" href="#__codelineno-5-179"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-180" name="__codelineno-5-180" href="#__codelineno-5-180"></a><span class="w">      </span><span class="nt">RouteTableId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PublicRouteTableB</span><span class="w"></span>
<a id="__codelineno-5-181" name="__codelineno-5-181" href="#__codelineno-5-181"></a><span class="w">      </span><span class="nt">SubnetId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PublicSubnet2</span><span class="w"></span>
<a id="__codelineno-5-182" name="__codelineno-5-182" href="#__codelineno-5-182"></a><span class="w">  </span><span class="nt">PublicSubnetAssoc3</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-183" name="__codelineno-5-183" href="#__codelineno-5-183"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::SubnetRouteTableAssociation</span><span class="w"></span>
<a id="__codelineno-5-184" name="__codelineno-5-184" href="#__codelineno-5-184"></a><span class="w">    </span><span class="nt">Condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build4AZs</span><span class="w"></span>
<a id="__codelineno-5-185" name="__codelineno-5-185" href="#__codelineno-5-185"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-186" name="__codelineno-5-186" href="#__codelineno-5-186"></a><span class="w">      </span><span class="nt">RouteTableId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PublicRouteTableA</span><span class="w"></span>
<a id="__codelineno-5-187" name="__codelineno-5-187" href="#__codelineno-5-187"></a><span class="w">      </span><span class="nt">SubnetId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PublicSubnet3</span><span class="w"></span>
<a id="__codelineno-5-188" name="__codelineno-5-188" href="#__codelineno-5-188"></a><span class="w">  </span><span class="nt">PublicSubnetAssoc4</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-189" name="__codelineno-5-189" href="#__codelineno-5-189"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::SubnetRouteTableAssociation</span><span class="w"></span>
<a id="__codelineno-5-190" name="__codelineno-5-190" href="#__codelineno-5-190"></a><span class="w">    </span><span class="nt">Condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build4AZs</span><span class="w"></span>
<a id="__codelineno-5-191" name="__codelineno-5-191" href="#__codelineno-5-191"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-192" name="__codelineno-5-192" href="#__codelineno-5-192"></a><span class="w">      </span><span class="nt">RouteTableId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PublicRouteTableB</span><span class="w"></span>
<a id="__codelineno-5-193" name="__codelineno-5-193" href="#__codelineno-5-193"></a><span class="w">      </span><span class="nt">SubnetId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PublicSubnet4</span><span class="w"></span>
<a id="__codelineno-5-194" name="__codelineno-5-194" href="#__codelineno-5-194"></a>
<a id="__codelineno-5-195" name="__codelineno-5-195" href="#__codelineno-5-195"></a><span class="c1">###############################################</span><span class="w"></span>
<a id="__codelineno-5-196" name="__codelineno-5-196" href="#__codelineno-5-196"></a><span class="c1">### Private/Application Tier (inbound)     ####</span><span class="w"></span>
<a id="__codelineno-5-197" name="__codelineno-5-197" href="#__codelineno-5-197"></a><span class="c1">############################################### </span><span class="w"></span>
<a id="__codelineno-5-198" name="__codelineno-5-198" href="#__codelineno-5-198"></a><span class="w">  </span><span class="nt">AppRouteTableA</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-199" name="__codelineno-5-199" href="#__codelineno-5-199"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::RouteTable</span><span class="w"></span>
<a id="__codelineno-5-200" name="__codelineno-5-200" href="#__codelineno-5-200"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-201" name="__codelineno-5-201" href="#__codelineno-5-201"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-202" name="__codelineno-5-202" href="#__codelineno-5-202"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-203" name="__codelineno-5-203" href="#__codelineno-5-203"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;private&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;rt-1a&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-204" name="__codelineno-5-204" href="#__codelineno-5-204"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-205" name="__codelineno-5-205" href="#__codelineno-5-205"></a><span class="w">        </span><span class="nt">Ref</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-5-206" name="__codelineno-5-206" href="#__codelineno-5-206"></a><span class="w">  </span><span class="nt">AppRouteTableB</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-207" name="__codelineno-5-207" href="#__codelineno-5-207"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::RouteTable</span><span class="w"></span>
<a id="__codelineno-5-208" name="__codelineno-5-208" href="#__codelineno-5-208"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-209" name="__codelineno-5-209" href="#__codelineno-5-209"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-210" name="__codelineno-5-210" href="#__codelineno-5-210"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-211" name="__codelineno-5-211" href="#__codelineno-5-211"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;private&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;rt-1b&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-212" name="__codelineno-5-212" href="#__codelineno-5-212"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-213" name="__codelineno-5-213" href="#__codelineno-5-213"></a><span class="w">        </span><span class="nt">Ref</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w">        </span>
<a id="__codelineno-5-214" name="__codelineno-5-214" href="#__codelineno-5-214"></a><span class="c1">###############################################</span><span class="w"></span>
<a id="__codelineno-5-215" name="__codelineno-5-215" href="#__codelineno-5-215"></a><span class="w">  </span><span class="nt">AppSubnet1</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-216" name="__codelineno-5-216" href="#__codelineno-5-216"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::Subnet</span><span class="w"></span>
<a id="__codelineno-5-217" name="__codelineno-5-217" href="#__codelineno-5-217"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-218" name="__codelineno-5-218" href="#__codelineno-5-218"></a><span class="w">      </span><span class="nt">AvailabilityZone</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!GetAZs</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="p p-Indicator">]</span><span class="w"></span>
<a id="__codelineno-5-219" name="__codelineno-5-219" href="#__codelineno-5-219"></a><span class="w">      </span><span class="nt">CidrBlock</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">4</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Cidr</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">CidrBlock</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">SubnetBits</span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-220" name="__codelineno-5-220" href="#__codelineno-5-220"></a><span class="w">      </span><span class="nt">MapPublicIpOnLaunch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<a id="__codelineno-5-221" name="__codelineno-5-221" href="#__codelineno-5-221"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-222" name="__codelineno-5-222" href="#__codelineno-5-222"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-223" name="__codelineno-5-223" href="#__codelineno-5-223"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;private&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;subnet-1a&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-224" name="__codelineno-5-224" href="#__codelineno-5-224"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-5-225" name="__codelineno-5-225" href="#__codelineno-5-225"></a><span class="w">  </span><span class="nt">AppSubnet2</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-226" name="__codelineno-5-226" href="#__codelineno-5-226"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::Subnet</span><span class="w"></span>
<a id="__codelineno-5-227" name="__codelineno-5-227" href="#__codelineno-5-227"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-228" name="__codelineno-5-228" href="#__codelineno-5-228"></a><span class="w">      </span><span class="nt">AvailabilityZone</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!GetAZs</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="p p-Indicator">]</span><span class="w">     </span>
<a id="__codelineno-5-229" name="__codelineno-5-229" href="#__codelineno-5-229"></a><span class="w">      </span><span class="nt">CidrBlock</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">5</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Cidr</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">CidrBlock</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">SubnetBits</span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-230" name="__codelineno-5-230" href="#__codelineno-5-230"></a><span class="w">      </span><span class="nt">MapPublicIpOnLaunch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<a id="__codelineno-5-231" name="__codelineno-5-231" href="#__codelineno-5-231"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-232" name="__codelineno-5-232" href="#__codelineno-5-232"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-233" name="__codelineno-5-233" href="#__codelineno-5-233"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;private&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;subnet-1b&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-234" name="__codelineno-5-234" href="#__codelineno-5-234"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-5-235" name="__codelineno-5-235" href="#__codelineno-5-235"></a><span class="w">  </span><span class="nt">AppSubnet3</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-236" name="__codelineno-5-236" href="#__codelineno-5-236"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::Subnet</span><span class="w"></span>
<a id="__codelineno-5-237" name="__codelineno-5-237" href="#__codelineno-5-237"></a><span class="w">    </span><span class="nt">Condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build4AZs</span><span class="w"></span>
<a id="__codelineno-5-238" name="__codelineno-5-238" href="#__codelineno-5-238"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-239" name="__codelineno-5-239" href="#__codelineno-5-239"></a><span class="w">      </span><span class="nt">AvailabilityZone</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!GetAZs</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="p p-Indicator">]</span><span class="w"></span>
<a id="__codelineno-5-240" name="__codelineno-5-240" href="#__codelineno-5-240"></a><span class="w">      </span><span class="nt">CidrBlock</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">6</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Cidr</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">CidrBlock</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">SubnetBits</span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-241" name="__codelineno-5-241" href="#__codelineno-5-241"></a><span class="w">      </span><span class="nt">MapPublicIpOnLaunch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<a id="__codelineno-5-242" name="__codelineno-5-242" href="#__codelineno-5-242"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-243" name="__codelineno-5-243" href="#__codelineno-5-243"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-244" name="__codelineno-5-244" href="#__codelineno-5-244"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;private&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;subnet-1c&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-245" name="__codelineno-5-245" href="#__codelineno-5-245"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-5-246" name="__codelineno-5-246" href="#__codelineno-5-246"></a><span class="w">  </span><span class="nt">AppSubnet4</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-247" name="__codelineno-5-247" href="#__codelineno-5-247"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::Subnet</span><span class="w"></span>
<a id="__codelineno-5-248" name="__codelineno-5-248" href="#__codelineno-5-248"></a><span class="w">    </span><span class="nt">Condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build4AZs</span><span class="w"></span>
<a id="__codelineno-5-249" name="__codelineno-5-249" href="#__codelineno-5-249"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-250" name="__codelineno-5-250" href="#__codelineno-5-250"></a><span class="w">      </span><span class="nt">AvailabilityZone</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!GetAZs</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="p p-Indicator">]</span><span class="w">     </span>
<a id="__codelineno-5-251" name="__codelineno-5-251" href="#__codelineno-5-251"></a><span class="w">      </span><span class="nt">CidrBlock</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">7</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Cidr</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">CidrBlock</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">SubnetBits</span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-252" name="__codelineno-5-252" href="#__codelineno-5-252"></a><span class="w">      </span><span class="nt">MapPublicIpOnLaunch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<a id="__codelineno-5-253" name="__codelineno-5-253" href="#__codelineno-5-253"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-254" name="__codelineno-5-254" href="#__codelineno-5-254"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-255" name="__codelineno-5-255" href="#__codelineno-5-255"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;private&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;subnet-1d&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-256" name="__codelineno-5-256" href="#__codelineno-5-256"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-5-257" name="__codelineno-5-257" href="#__codelineno-5-257"></a><span class="c1">###############################################</span><span class="w"></span>
<a id="__codelineno-5-258" name="__codelineno-5-258" href="#__codelineno-5-258"></a><span class="w">  </span><span class="nt">AppSubnetAssoc1</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-259" name="__codelineno-5-259" href="#__codelineno-5-259"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::SubnetRouteTableAssociation</span><span class="w"></span>
<a id="__codelineno-5-260" name="__codelineno-5-260" href="#__codelineno-5-260"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-261" name="__codelineno-5-261" href="#__codelineno-5-261"></a><span class="w">      </span><span class="nt">RouteTableId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AppRouteTableA</span><span class="w"></span>
<a id="__codelineno-5-262" name="__codelineno-5-262" href="#__codelineno-5-262"></a><span class="w">      </span><span class="nt">SubnetId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AppSubnet1</span><span class="w"></span>
<a id="__codelineno-5-263" name="__codelineno-5-263" href="#__codelineno-5-263"></a><span class="w">  </span><span class="nt">AppSubnetAssoc2</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-264" name="__codelineno-5-264" href="#__codelineno-5-264"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::SubnetRouteTableAssociation</span><span class="w"></span>
<a id="__codelineno-5-265" name="__codelineno-5-265" href="#__codelineno-5-265"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-266" name="__codelineno-5-266" href="#__codelineno-5-266"></a><span class="w">      </span><span class="nt">RouteTableId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AppRouteTableB</span><span class="w"></span>
<a id="__codelineno-5-267" name="__codelineno-5-267" href="#__codelineno-5-267"></a><span class="w">      </span><span class="nt">SubnetId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AppSubnet2</span><span class="w"></span>
<a id="__codelineno-5-268" name="__codelineno-5-268" href="#__codelineno-5-268"></a><span class="w">  </span><span class="nt">AppSubnetAssoc3</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-269" name="__codelineno-5-269" href="#__codelineno-5-269"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::SubnetRouteTableAssociation</span><span class="w"></span>
<a id="__codelineno-5-270" name="__codelineno-5-270" href="#__codelineno-5-270"></a><span class="w">    </span><span class="nt">Condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build4AZs</span><span class="w"></span>
<a id="__codelineno-5-271" name="__codelineno-5-271" href="#__codelineno-5-271"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-272" name="__codelineno-5-272" href="#__codelineno-5-272"></a><span class="w">      </span><span class="nt">RouteTableId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AppRouteTableA</span><span class="w"></span>
<a id="__codelineno-5-273" name="__codelineno-5-273" href="#__codelineno-5-273"></a><span class="w">      </span><span class="nt">SubnetId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AppSubnet3</span><span class="w"></span>
<a id="__codelineno-5-274" name="__codelineno-5-274" href="#__codelineno-5-274"></a><span class="w">  </span><span class="nt">AppSubnetAssoc4</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-275" name="__codelineno-5-275" href="#__codelineno-5-275"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::SubnetRouteTableAssociation</span><span class="w"></span>
<a id="__codelineno-5-276" name="__codelineno-5-276" href="#__codelineno-5-276"></a><span class="w">    </span><span class="nt">Condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build4AZs</span><span class="w"></span>
<a id="__codelineno-5-277" name="__codelineno-5-277" href="#__codelineno-5-277"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-278" name="__codelineno-5-278" href="#__codelineno-5-278"></a><span class="w">      </span><span class="nt">RouteTableId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AppRouteTableB</span><span class="w"></span>
<a id="__codelineno-5-279" name="__codelineno-5-279" href="#__codelineno-5-279"></a><span class="w">      </span><span class="nt">SubnetId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AppSubnet4</span><span class="w"></span>
<a id="__codelineno-5-280" name="__codelineno-5-280" href="#__codelineno-5-280"></a><span class="c1">###############################################</span><span class="w"></span>
<a id="__codelineno-5-281" name="__codelineno-5-281" href="#__codelineno-5-281"></a><span class="w">  </span><span class="nt">NatGatewayAEIP</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-282" name="__codelineno-5-282" href="#__codelineno-5-282"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;AWS::EC2::EIP&#39;</span><span class="w"></span>
<a id="__codelineno-5-283" name="__codelineno-5-283" href="#__codelineno-5-283"></a><span class="w">    </span><span class="nt">DependsOn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPCGatewayAttachment</span><span class="w">  </span>
<a id="__codelineno-5-284" name="__codelineno-5-284" href="#__codelineno-5-284"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-285" name="__codelineno-5-285" href="#__codelineno-5-285"></a><span class="w">      </span><span class="nt">Domain</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc</span><span class="w"></span>
<a id="__codelineno-5-286" name="__codelineno-5-286" href="#__codelineno-5-286"></a><span class="w">  </span><span class="nt">NatGatewayA</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-287" name="__codelineno-5-287" href="#__codelineno-5-287"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;AWS::EC2::NatGateway&#39;</span><span class="w"></span>
<a id="__codelineno-5-288" name="__codelineno-5-288" href="#__codelineno-5-288"></a><span class="w">    </span><span class="nt">DependsOn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NatGatewayAEIP</span><span class="w">  </span>
<a id="__codelineno-5-289" name="__codelineno-5-289" href="#__codelineno-5-289"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-290" name="__codelineno-5-290" href="#__codelineno-5-290"></a><span class="w">      </span><span class="nt">AllocationId</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-291" name="__codelineno-5-291" href="#__codelineno-5-291"></a><span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">Fn::GetAtt</span><span class="p p-Indicator">:</span><span class="w"></span>
<a id="__codelineno-5-292" name="__codelineno-5-292" href="#__codelineno-5-292"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NatGatewayAEIP</span><span class="w"></span>
<a id="__codelineno-5-293" name="__codelineno-5-293" href="#__codelineno-5-293"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AllocationId</span><span class="w"></span>
<a id="__codelineno-5-294" name="__codelineno-5-294" href="#__codelineno-5-294"></a><span class="w">      </span><span class="nt">SubnetId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AppSubnet1</span><span class="w"></span>
<a id="__codelineno-5-295" name="__codelineno-5-295" href="#__codelineno-5-295"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-296" name="__codelineno-5-296" href="#__codelineno-5-296"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-297" name="__codelineno-5-297" href="#__codelineno-5-297"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;natgw&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;1a&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-298" name="__codelineno-5-298" href="#__codelineno-5-298"></a><span class="c1">###############################################</span><span class="w"></span>
<a id="__codelineno-5-299" name="__codelineno-5-299" href="#__codelineno-5-299"></a><span class="w">  </span><span class="nt">NatGatewayBEIP</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-300" name="__codelineno-5-300" href="#__codelineno-5-300"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;AWS::EC2::EIP&#39;</span><span class="w"></span>
<a id="__codelineno-5-301" name="__codelineno-5-301" href="#__codelineno-5-301"></a><span class="w">    </span><span class="nt">DependsOn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPCGatewayAttachment</span><span class="w">  </span>
<a id="__codelineno-5-302" name="__codelineno-5-302" href="#__codelineno-5-302"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-303" name="__codelineno-5-303" href="#__codelineno-5-303"></a><span class="w">      </span><span class="nt">Domain</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc</span><span class="w"></span>
<a id="__codelineno-5-304" name="__codelineno-5-304" href="#__codelineno-5-304"></a><span class="w">  </span><span class="nt">NatGatewayB</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-305" name="__codelineno-5-305" href="#__codelineno-5-305"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;AWS::EC2::NatGateway&#39;</span><span class="w"></span>
<a id="__codelineno-5-306" name="__codelineno-5-306" href="#__codelineno-5-306"></a><span class="w">    </span><span class="nt">DependsOn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NatGatewayBEIP</span><span class="w"> </span>
<a id="__codelineno-5-307" name="__codelineno-5-307" href="#__codelineno-5-307"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-308" name="__codelineno-5-308" href="#__codelineno-5-308"></a><span class="w">      </span><span class="nt">AllocationId</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-309" name="__codelineno-5-309" href="#__codelineno-5-309"></a><span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">Fn::GetAtt</span><span class="p p-Indicator">:</span><span class="w"></span>
<a id="__codelineno-5-310" name="__codelineno-5-310" href="#__codelineno-5-310"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NatGatewayBEIP</span><span class="w"></span>
<a id="__codelineno-5-311" name="__codelineno-5-311" href="#__codelineno-5-311"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AllocationId</span><span class="w"></span>
<a id="__codelineno-5-312" name="__codelineno-5-312" href="#__codelineno-5-312"></a><span class="w">      </span><span class="nt">SubnetId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AppSubnet2</span><span class="w"></span>
<a id="__codelineno-5-313" name="__codelineno-5-313" href="#__codelineno-5-313"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-314" name="__codelineno-5-314" href="#__codelineno-5-314"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-315" name="__codelineno-5-315" href="#__codelineno-5-315"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;natgw&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;1b&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-316" name="__codelineno-5-316" href="#__codelineno-5-316"></a><span class="c1">###############################################</span><span class="w"></span>
<a id="__codelineno-5-317" name="__codelineno-5-317" href="#__codelineno-5-317"></a><span class="w">  </span><span class="nt">AppRouteTableARoute</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-318" name="__codelineno-5-318" href="#__codelineno-5-318"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;AWS::EC2::Route&#39;</span><span class="w"></span>
<a id="__codelineno-5-319" name="__codelineno-5-319" href="#__codelineno-5-319"></a><span class="w">    </span><span class="nt">DependsOn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPCGatewayAttachment</span><span class="w"></span>
<a id="__codelineno-5-320" name="__codelineno-5-320" href="#__codelineno-5-320"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-321" name="__codelineno-5-321" href="#__codelineno-5-321"></a><span class="w">      </span><span class="nt">RouteTableId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AppRouteTableA</span><span class="w"></span>
<a id="__codelineno-5-322" name="__codelineno-5-322" href="#__codelineno-5-322"></a><span class="w">      </span><span class="nt">DestinationCidrBlock</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0.0.0.0/0&#39;</span><span class="w"></span>
<a id="__codelineno-5-323" name="__codelineno-5-323" href="#__codelineno-5-323"></a><span class="w">      </span><span class="nt">NatGatewayId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NatGatewayA</span><span class="w"></span>
<a id="__codelineno-5-324" name="__codelineno-5-324" href="#__codelineno-5-324"></a><span class="w">  </span><span class="nt">AppRouteTableBRoute</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-325" name="__codelineno-5-325" href="#__codelineno-5-325"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;AWS::EC2::Route&#39;</span><span class="w"></span>
<a id="__codelineno-5-326" name="__codelineno-5-326" href="#__codelineno-5-326"></a><span class="w">    </span><span class="nt">DependsOn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPCGatewayAttachment</span><span class="w"></span>
<a id="__codelineno-5-327" name="__codelineno-5-327" href="#__codelineno-5-327"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-328" name="__codelineno-5-328" href="#__codelineno-5-328"></a><span class="w">      </span><span class="nt">RouteTableId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AppRouteTableB</span><span class="w"></span>
<a id="__codelineno-5-329" name="__codelineno-5-329" href="#__codelineno-5-329"></a><span class="w">      </span><span class="nt">DestinationCidrBlock</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0.0.0.0/0&#39;</span><span class="w"></span>
<a id="__codelineno-5-330" name="__codelineno-5-330" href="#__codelineno-5-330"></a><span class="w">      </span><span class="nt">NatGatewayId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NatGatewayB</span><span class="w"></span>
<a id="__codelineno-5-331" name="__codelineno-5-331" href="#__codelineno-5-331"></a>
<a id="__codelineno-5-332" name="__codelineno-5-332" href="#__codelineno-5-332"></a><span class="c1">###############################################</span><span class="w"></span>
<a id="__codelineno-5-333" name="__codelineno-5-333" href="#__codelineno-5-333"></a><span class="c1">### Local/Database Tier (local-access)     ####</span><span class="w"></span>
<a id="__codelineno-5-334" name="__codelineno-5-334" href="#__codelineno-5-334"></a><span class="c1">###############################################</span><span class="w"></span>
<a id="__codelineno-5-335" name="__codelineno-5-335" href="#__codelineno-5-335"></a><span class="w">  </span><span class="nt">BDRouteTableA</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-336" name="__codelineno-5-336" href="#__codelineno-5-336"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::RouteTable</span><span class="w"></span>
<a id="__codelineno-5-337" name="__codelineno-5-337" href="#__codelineno-5-337"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-338" name="__codelineno-5-338" href="#__codelineno-5-338"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-339" name="__codelineno-5-339" href="#__codelineno-5-339"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-340" name="__codelineno-5-340" href="#__codelineno-5-340"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;local&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;rt-1a&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-341" name="__codelineno-5-341" href="#__codelineno-5-341"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-342" name="__codelineno-5-342" href="#__codelineno-5-342"></a><span class="w">        </span><span class="nt">Ref</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-5-343" name="__codelineno-5-343" href="#__codelineno-5-343"></a><span class="w">  </span><span class="nt">BDRouteTableB</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-344" name="__codelineno-5-344" href="#__codelineno-5-344"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::RouteTable</span><span class="w"></span>
<a id="__codelineno-5-345" name="__codelineno-5-345" href="#__codelineno-5-345"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-346" name="__codelineno-5-346" href="#__codelineno-5-346"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-347" name="__codelineno-5-347" href="#__codelineno-5-347"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-348" name="__codelineno-5-348" href="#__codelineno-5-348"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;local&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;rt-1b&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-349" name="__codelineno-5-349" href="#__codelineno-5-349"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-350" name="__codelineno-5-350" href="#__codelineno-5-350"></a><span class="w">        </span><span class="nt">Ref</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w">          </span>
<a id="__codelineno-5-351" name="__codelineno-5-351" href="#__codelineno-5-351"></a><span class="c1">###############################################</span><span class="w"></span>
<a id="__codelineno-5-352" name="__codelineno-5-352" href="#__codelineno-5-352"></a><span class="w">  </span><span class="nt">BDSubnet1</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-353" name="__codelineno-5-353" href="#__codelineno-5-353"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::Subnet</span><span class="w"></span>
<a id="__codelineno-5-354" name="__codelineno-5-354" href="#__codelineno-5-354"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-355" name="__codelineno-5-355" href="#__codelineno-5-355"></a><span class="w">      </span><span class="nt">AvailabilityZone</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!GetAZs</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="p p-Indicator">]</span><span class="w"></span>
<a id="__codelineno-5-356" name="__codelineno-5-356" href="#__codelineno-5-356"></a><span class="w">      </span><span class="nt">CidrBlock</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Cidr</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">CidrBlock</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">SubnetBits</span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-357" name="__codelineno-5-357" href="#__codelineno-5-357"></a><span class="w">      </span><span class="nt">MapPublicIpOnLaunch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<a id="__codelineno-5-358" name="__codelineno-5-358" href="#__codelineno-5-358"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-359" name="__codelineno-5-359" href="#__codelineno-5-359"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-360" name="__codelineno-5-360" href="#__codelineno-5-360"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;local&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;subnet-1a&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-361" name="__codelineno-5-361" href="#__codelineno-5-361"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-5-362" name="__codelineno-5-362" href="#__codelineno-5-362"></a><span class="w">  </span><span class="nt">BDSubnet2</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-363" name="__codelineno-5-363" href="#__codelineno-5-363"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::Subnet</span><span class="w"></span>
<a id="__codelineno-5-364" name="__codelineno-5-364" href="#__codelineno-5-364"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-365" name="__codelineno-5-365" href="#__codelineno-5-365"></a><span class="w">      </span><span class="nt">AvailabilityZone</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!GetAZs</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="p p-Indicator">]</span><span class="w">     </span>
<a id="__codelineno-5-366" name="__codelineno-5-366" href="#__codelineno-5-366"></a><span class="w">      </span><span class="nt">CidrBlock</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">9</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Cidr</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">CidrBlock</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">SubnetBits</span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-367" name="__codelineno-5-367" href="#__codelineno-5-367"></a><span class="w">      </span><span class="nt">MapPublicIpOnLaunch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<a id="__codelineno-5-368" name="__codelineno-5-368" href="#__codelineno-5-368"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-369" name="__codelineno-5-369" href="#__codelineno-5-369"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-370" name="__codelineno-5-370" href="#__codelineno-5-370"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;local&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;subnet-1b&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-371" name="__codelineno-5-371" href="#__codelineno-5-371"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-5-372" name="__codelineno-5-372" href="#__codelineno-5-372"></a><span class="w">  </span><span class="nt">BDSubnet3</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-373" name="__codelineno-5-373" href="#__codelineno-5-373"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::Subnet</span><span class="w"></span>
<a id="__codelineno-5-374" name="__codelineno-5-374" href="#__codelineno-5-374"></a><span class="w">    </span><span class="nt">Condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build4AZs</span><span class="w"></span>
<a id="__codelineno-5-375" name="__codelineno-5-375" href="#__codelineno-5-375"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-376" name="__codelineno-5-376" href="#__codelineno-5-376"></a><span class="w">      </span><span class="nt">AvailabilityZone</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!GetAZs</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="p p-Indicator">]</span><span class="w"></span>
<a id="__codelineno-5-377" name="__codelineno-5-377" href="#__codelineno-5-377"></a><span class="w">      </span><span class="nt">CidrBlock</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">10</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Cidr</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">CidrBlock</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">SubnetBits</span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-378" name="__codelineno-5-378" href="#__codelineno-5-378"></a><span class="w">      </span><span class="nt">MapPublicIpOnLaunch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<a id="__codelineno-5-379" name="__codelineno-5-379" href="#__codelineno-5-379"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-380" name="__codelineno-5-380" href="#__codelineno-5-380"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-381" name="__codelineno-5-381" href="#__codelineno-5-381"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;local&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;subnet-1c&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-382" name="__codelineno-5-382" href="#__codelineno-5-382"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-5-383" name="__codelineno-5-383" href="#__codelineno-5-383"></a><span class="w">  </span><span class="nt">BDSubnet4</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-384" name="__codelineno-5-384" href="#__codelineno-5-384"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::Subnet</span><span class="w"></span>
<a id="__codelineno-5-385" name="__codelineno-5-385" href="#__codelineno-5-385"></a><span class="w">    </span><span class="nt">Condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build4AZs</span><span class="w"></span>
<a id="__codelineno-5-386" name="__codelineno-5-386" href="#__codelineno-5-386"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-387" name="__codelineno-5-387" href="#__codelineno-5-387"></a><span class="w">      </span><span class="nt">AvailabilityZone</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!GetAZs</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="p p-Indicator">]</span><span class="w">     </span>
<a id="__codelineno-5-388" name="__codelineno-5-388" href="#__codelineno-5-388"></a><span class="w">      </span><span class="nt">CidrBlock</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">11</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Cidr</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">CidrBlock</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">SubnetBits</span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-389" name="__codelineno-5-389" href="#__codelineno-5-389"></a><span class="w">      </span><span class="nt">MapPublicIpOnLaunch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<a id="__codelineno-5-390" name="__codelineno-5-390" href="#__codelineno-5-390"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-391" name="__codelineno-5-391" href="#__codelineno-5-391"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-5-392" name="__codelineno-5-392" href="#__codelineno-5-392"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;local&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;subnet-1d&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-5-393" name="__codelineno-5-393" href="#__codelineno-5-393"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-5-394" name="__codelineno-5-394" href="#__codelineno-5-394"></a><span class="c1">###############################################</span><span class="w"></span>
<a id="__codelineno-5-395" name="__codelineno-5-395" href="#__codelineno-5-395"></a><span class="w">  </span><span class="nt">BDSubnetAssoc1</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-396" name="__codelineno-5-396" href="#__codelineno-5-396"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::SubnetRouteTableAssociation</span><span class="w"></span>
<a id="__codelineno-5-397" name="__codelineno-5-397" href="#__codelineno-5-397"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-398" name="__codelineno-5-398" href="#__codelineno-5-398"></a><span class="w">      </span><span class="nt">RouteTableId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BDRouteTableA</span><span class="w"></span>
<a id="__codelineno-5-399" name="__codelineno-5-399" href="#__codelineno-5-399"></a><span class="w">      </span><span class="nt">SubnetId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BDSubnet1</span><span class="w"></span>
<a id="__codelineno-5-400" name="__codelineno-5-400" href="#__codelineno-5-400"></a><span class="w">  </span><span class="nt">BDSubnetAssoc2</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-401" name="__codelineno-5-401" href="#__codelineno-5-401"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::SubnetRouteTableAssociation</span><span class="w"></span>
<a id="__codelineno-5-402" name="__codelineno-5-402" href="#__codelineno-5-402"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-403" name="__codelineno-5-403" href="#__codelineno-5-403"></a><span class="w">      </span><span class="nt">RouteTableId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BDRouteTableB</span><span class="w"></span>
<a id="__codelineno-5-404" name="__codelineno-5-404" href="#__codelineno-5-404"></a><span class="w">      </span><span class="nt">SubnetId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BDSubnet2</span><span class="w"></span>
<a id="__codelineno-5-405" name="__codelineno-5-405" href="#__codelineno-5-405"></a><span class="w">  </span><span class="nt">BDSubnetAssoc3</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-406" name="__codelineno-5-406" href="#__codelineno-5-406"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::SubnetRouteTableAssociation</span><span class="w"></span>
<a id="__codelineno-5-407" name="__codelineno-5-407" href="#__codelineno-5-407"></a><span class="w">    </span><span class="nt">Condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build4AZs</span><span class="w"></span>
<a id="__codelineno-5-408" name="__codelineno-5-408" href="#__codelineno-5-408"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-409" name="__codelineno-5-409" href="#__codelineno-5-409"></a><span class="w">      </span><span class="nt">RouteTableId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BDRouteTableA</span><span class="w"></span>
<a id="__codelineno-5-410" name="__codelineno-5-410" href="#__codelineno-5-410"></a><span class="w">      </span><span class="nt">SubnetId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BDSubnet3</span><span class="w"></span>
<a id="__codelineno-5-411" name="__codelineno-5-411" href="#__codelineno-5-411"></a><span class="w">  </span><span class="nt">BDSubnetAssoc4</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-412" name="__codelineno-5-412" href="#__codelineno-5-412"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::SubnetRouteTableAssociation</span><span class="w"></span>
<a id="__codelineno-5-413" name="__codelineno-5-413" href="#__codelineno-5-413"></a><span class="w">    </span><span class="nt">Condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build4AZs</span><span class="w"></span>
<a id="__codelineno-5-414" name="__codelineno-5-414" href="#__codelineno-5-414"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-415" name="__codelineno-5-415" href="#__codelineno-5-415"></a><span class="w">      </span><span class="nt">RouteTableId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BDRouteTableB</span><span class="w"></span>
<a id="__codelineno-5-416" name="__codelineno-5-416" href="#__codelineno-5-416"></a><span class="w">      </span><span class="nt">SubnetId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BDSubnet4</span><span class="w"></span>
<a id="__codelineno-5-417" name="__codelineno-5-417" href="#__codelineno-5-417"></a><span class="c1">###############################################</span><span class="w"></span>
<a id="__codelineno-5-418" name="__codelineno-5-418" href="#__codelineno-5-418"></a><span class="w">  </span><span class="nt">PublicRouteTableRouteA</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-419" name="__codelineno-5-419" href="#__codelineno-5-419"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;AWS::EC2::Route&#39;</span><span class="w"></span>
<a id="__codelineno-5-420" name="__codelineno-5-420" href="#__codelineno-5-420"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-421" name="__codelineno-5-421" href="#__codelineno-5-421"></a><span class="w">      </span><span class="nt">RouteTableId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PublicRouteTableA</span><span class="w"></span>
<a id="__codelineno-5-422" name="__codelineno-5-422" href="#__codelineno-5-422"></a><span class="w">      </span><span class="nt">DestinationCidrBlock</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0.0.0.0/0&#39;</span><span class="w"></span>
<a id="__codelineno-5-423" name="__codelineno-5-423" href="#__codelineno-5-423"></a><span class="w">      </span><span class="nt">GatewayId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">InternetGateway</span><span class="w"></span>
<a id="__codelineno-5-424" name="__codelineno-5-424" href="#__codelineno-5-424"></a><span class="w">  </span><span class="nt">PublicRouteTableRouteB</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-425" name="__codelineno-5-425" href="#__codelineno-5-425"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;AWS::EC2::Route&#39;</span><span class="w"></span>
<a id="__codelineno-5-426" name="__codelineno-5-426" href="#__codelineno-5-426"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-5-427" name="__codelineno-5-427" href="#__codelineno-5-427"></a><span class="w">      </span><span class="nt">RouteTableId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PublicRouteTableB</span><span class="w"></span>
<a id="__codelineno-5-428" name="__codelineno-5-428" href="#__codelineno-5-428"></a><span class="w">      </span><span class="nt">DestinationCidrBlock</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0.0.0.0/0&#39;</span><span class="w"></span>
<a id="__codelineno-5-429" name="__codelineno-5-429" href="#__codelineno-5-429"></a><span class="w">      </span><span class="nt">GatewayId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">InternetGateway</span><span class="w"></span>
<a id="__codelineno-5-430" name="__codelineno-5-430" href="#__codelineno-5-430"></a><span class="err">````</span><span class="w"></span>
<a id="__codelineno-5-431" name="__codelineno-5-431" href="#__codelineno-5-431"></a>
<a id="__codelineno-5-432" name="__codelineno-5-432" href="#__codelineno-5-432"></a><span class="l l-Scalar l-Scalar-Plain">&lt;/div&gt;</span><span class="w"></span>
<a id="__codelineno-5-433" name="__codelineno-5-433" href="#__codelineno-5-433"></a>
<a id="__codelineno-5-434" name="__codelineno-5-434" href="#__codelineno-5-434"></a><span class="c1">#### Cloudformation Nested Functions</span><span class="w"></span>
<a id="__codelineno-5-435" name="__codelineno-5-435" href="#__codelineno-5-435"></a><span class="l l-Scalar l-Scalar-Plain">The above template is prone to error depending on the user inputs. Howerver there are complicated ways to reduce some of them.</span><span class="w"></span>
<a id="__codelineno-5-436" name="__codelineno-5-436" href="#__codelineno-5-436"></a>
<a id="__codelineno-5-437" name="__codelineno-5-437" href="#__codelineno-5-437"></a><span class="nt">* ***Problem***</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-438" name="__codelineno-5-438" href="#__codelineno-5-438"></a><span class="w">  </span><span class="nt">Assume user provides a CidrBlock</span><span class="p">:</span><span class="w"> </span><span class="err">```</span><span class="l l-Scalar l-Scalar-Plain">10.168.64.0/22``` and CidrBits:```8```. In order to generate enough Cidr Blocks for 4 AZs, the templace is requesting ```12``` smaller blocks. Since The ```/22``` CidrBlock only contains 4 ```/24&#39;s```, the cloudformation stack build will fail.</span><span class="w"></span>
<a id="__codelineno-5-439" name="__codelineno-5-439" href="#__codelineno-5-439"></a>
<a id="__codelineno-5-440" name="__codelineno-5-440" href="#__codelineno-5-440"></a><span class="nt">* ***Solution***</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-441" name="__codelineno-5-441" href="#__codelineno-5-441"></a><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">One possible solution would be to pick from a list of ```AllowedValues``` in the ```Parameters`` section and use ```Conditions``` to set ```CidrBits``` based on user choice using nested conditions in ```resources```.</span><span class="w"></span>
<a id="__codelineno-5-442" name="__codelineno-5-442" href="#__codelineno-5-442"></a>
<a id="__codelineno-5-443" name="__codelineno-5-443" href="#__codelineno-5-443"></a><span class="err">```</span><span class="l l-Scalar l-Scalar-Plain">yaml</span><span class="w"></span>
<a id="__codelineno-5-444" name="__codelineno-5-444" href="#__codelineno-5-444"></a><span class="nt">Conditions</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-445" name="__codelineno-5-445" href="#__codelineno-5-445"></a><span class="w">  </span><span class="nt">CidrBit8</span><span class="p">:</span><span class="w">    </span><span class="kt">!Equals</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">Cidr</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">20</span><span class="w"> </span><span class="p p-Indicator">]</span><span class="w"></span>
<a id="__codelineno-5-446" name="__codelineno-5-446" href="#__codelineno-5-446"></a><span class="w">  </span><span class="nt">CidrBit7</span><span class="p">:</span><span class="w">    </span><span class="kt">!Equals</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">Cidr</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">21</span><span class="w"> </span><span class="p p-Indicator">]</span><span class="w"></span>
<a id="__codelineno-5-447" name="__codelineno-5-447" href="#__codelineno-5-447"></a><span class="w">  </span><span class="nt">CidrBit6</span><span class="p">:</span><span class="w">    </span><span class="kt">!Equals</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">Cidr</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">22</span><span class="w"> </span><span class="p p-Indicator">]</span><span class="w"></span>
<a id="__codelineno-5-448" name="__codelineno-5-448" href="#__codelineno-5-448"></a>
<a id="__codelineno-5-449" name="__codelineno-5-449" href="#__codelineno-5-449"></a><span class="nt">Resources</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-5-450" name="__codelineno-5-450" href="#__codelineno-5-450"></a><span class="w">  </span><span class="kt">!If</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">CidrBit8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!If</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">CidrBit7</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">7</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">6</span><span class="p p-Indicator">]]</span><span class="w"></span>
</code></pre></div>

* ```!If [CidrBit8, 8, !If [CidrBit7, 7, 6]]``` 
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>    if CidrBit8 == True:
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>      cidrBit == 8
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    elif CidrBit7 == True:
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>      cidrBit == 7
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>    else:
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>      cidrBit = 6
</code></pre></div>

###### Cloudformation Snippet

<div style="width:1200px;height:600px;overflow:auto;">

<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="nt">AWSTemplateFormatVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2010-09-09</span><span class="w"></span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nt">Description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GTZ Three Tier VPC Template</span><span class="w"></span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="nt">Metadata</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">AWS::CloudFormation::Interface</span><span class="p p-Indicator">:</span><span class="w"> </span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">    </span><span class="nt">ParameterGroups</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Label</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">          </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Stack</span><span class="nv"> </span><span class="s">Name</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">{{ProjectName}}-{{Environment}}-three-tier-vpc-cf</span><span class="nv"> </span><span class="s">(i.e</span><span class="nv"> </span><span class="s">jira-dev-three-tier-vpc-cf)&quot;</span><span class="w"></span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Label</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">          </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;|&quot;</span><span class="w"></span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Label</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">          </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;VPC</span><span class="nv"> </span><span class="s">Configuration&quot;</span><span class="w"></span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">        </span><span class="nt">Parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ProjectName</span><span class="w"></span>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Environment</span><span class="w">          </span>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CidrBlock</span><span class="w"></span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Label</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="w">          </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Subnet</span><span class="nv"> </span><span class="s">8</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">/24(/20</span><span class="nv"> </span><span class="s">CidrBlock</span><span class="nv"> </span><span class="s">Required),</span><span class="nv"> </span><span class="s">7</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">/25</span><span class="nv"> </span><span class="s">(/21</span><span class="nv"> </span><span class="s">CidrBlock</span><span class="nv"> </span><span class="s">Required),</span><span class="nv"> </span><span class="s">6</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">/26</span><span class="nv"> </span><span class="s">(/22</span><span class="nv"> </span><span class="s">CidrBlock</span><span class="nv"> </span><span class="s">Required)&quot;</span><span class="w"></span>
<a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="w">        </span><span class="nt">Parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CidrMask</span><span class="w"></span>
<a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a>
<a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Label</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="w">          </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Availability</span><span class="nv"> </span><span class="s">Zones&quot;</span><span class="w"></span>
<a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a><span class="w">        </span><span class="nt">Parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NumberOfAZs</span><span class="w"></span>
<a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a>
<a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a><span class="nt">Parameters</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a><span class="w">  </span><span class="nt">ProjectName</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a><span class="w">    </span><span class="nt">Description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Project Name ( ex. jira /  sfpt / sec )</span><span class="w"></span>
<a id="__codelineno-7-29" name="__codelineno-7-29" href="#__codelineno-7-29"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">String</span><span class="w"></span>
<a id="__codelineno-7-30" name="__codelineno-7-30" href="#__codelineno-7-30"></a>
<a id="__codelineno-7-31" name="__codelineno-7-31" href="#__codelineno-7-31"></a><span class="w">  </span><span class="nt">CidrBlock1</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-32" name="__codelineno-7-32" href="#__codelineno-7-32"></a><span class="w">    </span><span class="nt">ConstraintDescription</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CIDR block parameter must be in the form x.x.x.x</span><span class="w"></span>
<a id="__codelineno-7-33" name="__codelineno-7-33" href="#__codelineno-7-33"></a><span class="w">    </span><span class="nt">Description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC valid IP Block ( ex. 10.168.0.0)</span><span class="w"></span>
<a id="__codelineno-7-34" name="__codelineno-7-34" href="#__codelineno-7-34"></a><span class="w">    </span><span class="nt">Default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.168.0.0</span><span class="w"></span>
<a id="__codelineno-7-35" name="__codelineno-7-35" href="#__codelineno-7-35"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">String</span><span class="w"></span>
<a id="__codelineno-7-36" name="__codelineno-7-36" href="#__codelineno-7-36"></a>
<a id="__codelineno-7-37" name="__codelineno-7-37" href="#__codelineno-7-37"></a>
<a id="__codelineno-7-38" name="__codelineno-7-38" href="#__codelineno-7-38"></a><span class="w">  </span><span class="nt">Cidr</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-39" name="__codelineno-7-39" href="#__codelineno-7-39"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Number</span><span class="w"></span>
<a id="__codelineno-7-40" name="__codelineno-7-40" href="#__codelineno-7-40"></a><span class="w">    </span><span class="nt">AllowedValues</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-7-41" name="__codelineno-7-41" href="#__codelineno-7-41"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span><span class="w"></span>
<a id="__codelineno-7-42" name="__codelineno-7-42" href="#__codelineno-7-42"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">22</span><span class="w"></span>
<a id="__codelineno-7-43" name="__codelineno-7-43" href="#__codelineno-7-43"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">21</span><span class="w"></span>
<a id="__codelineno-7-44" name="__codelineno-7-44" href="#__codelineno-7-44"></a><span class="w">    </span><span class="nt">Default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span><span class="w"></span>
<a id="__codelineno-7-45" name="__codelineno-7-45" href="#__codelineno-7-45"></a><span class="w">    </span><span class="nt">Description</span><span class="p">:</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">VPC valid IP CIDR Blocks /20&#39;s ( /24&#39;s smaller blocks )  , /21&#39;s ( /25&#39;s smaller blocks )and /22&#39;s ( /26&#39;s smaller blocks )</span><span class="w"></span>
<a id="__codelineno-7-46" name="__codelineno-7-46" href="#__codelineno-7-46"></a>
<a id="__codelineno-7-47" name="__codelineno-7-47" href="#__codelineno-7-47"></a><span class="w">  </span><span class="nt">NumberOfAZs</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-48" name="__codelineno-7-48" href="#__codelineno-7-48"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Number</span><span class="w"></span>
<a id="__codelineno-7-49" name="__codelineno-7-49" href="#__codelineno-7-49"></a><span class="w">    </span><span class="nt">AllowedValues</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-7-50" name="__codelineno-7-50" href="#__codelineno-7-50"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class="w"></span>
<a id="__codelineno-7-51" name="__codelineno-7-51" href="#__codelineno-7-51"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span><span class="w"></span>
<a id="__codelineno-7-52" name="__codelineno-7-52" href="#__codelineno-7-52"></a><span class="w">    </span><span class="nt">Default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class="w"></span>
<a id="__codelineno-7-53" name="__codelineno-7-53" href="#__codelineno-7-53"></a><span class="w">    </span><span class="nt">Description</span><span class="p">:</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">Availability Zones - 2 = 2 per Tier, 4 = 4 per Tier</span><span class="w"></span>
<a id="__codelineno-7-54" name="__codelineno-7-54" href="#__codelineno-7-54"></a>
<a id="__codelineno-7-55" name="__codelineno-7-55" href="#__codelineno-7-55"></a><span class="w">  </span><span class="nt">Environment</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-56" name="__codelineno-7-56" href="#__codelineno-7-56"></a><span class="w">    </span><span class="nt">Description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Choose VPC Type</span><span class="w"> </span>
<a id="__codelineno-7-57" name="__codelineno-7-57" href="#__codelineno-7-57"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">String</span><span class="w"></span>
<a id="__codelineno-7-58" name="__codelineno-7-58" href="#__codelineno-7-58"></a><span class="w">    </span><span class="nt">AllowedValues</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-7-59" name="__codelineno-7-59" href="#__codelineno-7-59"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dev</span><span class="w"></span>
<a id="__codelineno-7-60" name="__codelineno-7-60" href="#__codelineno-7-60"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test</span><span class="w"></span>
<a id="__codelineno-7-61" name="__codelineno-7-61" href="#__codelineno-7-61"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prod</span><span class="w"></span>
<a id="__codelineno-7-62" name="__codelineno-7-62" href="#__codelineno-7-62"></a>
<a id="__codelineno-7-63" name="__codelineno-7-63" href="#__codelineno-7-63"></a><span class="nt">Conditions</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-7-64" name="__codelineno-7-64" href="#__codelineno-7-64"></a><span class="w">  </span><span class="nt">Build4AZs</span><span class="p">:</span><span class="w">    </span><span class="kt">!Equals</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">NumberOfAZs</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">4</span><span class="w"> </span><span class="p p-Indicator">]</span><span class="w"></span>
<a id="__codelineno-7-65" name="__codelineno-7-65" href="#__codelineno-7-65"></a><span class="w">  </span><span class="nt">CidrBit8</span><span class="p">:</span><span class="w">    </span><span class="kt">!Equals</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">Cidr</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">20</span><span class="w"> </span><span class="p p-Indicator">]</span><span class="w"></span>
<a id="__codelineno-7-66" name="__codelineno-7-66" href="#__codelineno-7-66"></a><span class="w">  </span><span class="nt">CidrBit7</span><span class="p">:</span><span class="w">    </span><span class="kt">!Equals</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">Cidr</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">21</span><span class="w"> </span><span class="p p-Indicator">]</span><span class="w"></span>
<a id="__codelineno-7-67" name="__codelineno-7-67" href="#__codelineno-7-67"></a><span class="w">  </span><span class="nt">CidrBit6</span><span class="p">:</span><span class="w">    </span><span class="kt">!Equals</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">Cidr</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">22</span><span class="w"> </span><span class="p p-Indicator">]</span><span class="w"></span>
<a id="__codelineno-7-68" name="__codelineno-7-68" href="#__codelineno-7-68"></a>
<a id="__codelineno-7-69" name="__codelineno-7-69" href="#__codelineno-7-69"></a><span class="c1">###############################################</span><span class="w"></span>
<a id="__codelineno-7-70" name="__codelineno-7-70" href="#__codelineno-7-70"></a><span class="c1">### Three Tier VPC                         ####</span><span class="w"></span>
<a id="__codelineno-7-71" name="__codelineno-7-71" href="#__codelineno-7-71"></a><span class="c1">###############################################  </span><span class="w"></span>
<a id="__codelineno-7-72" name="__codelineno-7-72" href="#__codelineno-7-72"></a><span class="nt">Resources</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-73" name="__codelineno-7-73" href="#__codelineno-7-73"></a><span class="w">  </span><span class="nt">VPC</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-74" name="__codelineno-7-74" href="#__codelineno-7-74"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::VPC</span><span class="w"></span>
<a id="__codelineno-7-75" name="__codelineno-7-75" href="#__codelineno-7-75"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-76" name="__codelineno-7-76" href="#__codelineno-7-76"></a><span class="w">      </span><span class="nt">CidrBlock</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">CidrBlock1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">Cidr</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-7-77" name="__codelineno-7-77" href="#__codelineno-7-77"></a><span class="w">      </span><span class="nt">EnableDnsHostnames</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<a id="__codelineno-7-78" name="__codelineno-7-78" href="#__codelineno-7-78"></a><span class="w">      </span><span class="nt">EnableDnsSupport</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<a id="__codelineno-7-79" name="__codelineno-7-79" href="#__codelineno-7-79"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-80" name="__codelineno-7-80" href="#__codelineno-7-80"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-7-81" name="__codelineno-7-81" href="#__codelineno-7-81"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">Environment</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;three-tier&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;vpc&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-7-82" name="__codelineno-7-82" href="#__codelineno-7-82"></a>
<a id="__codelineno-7-83" name="__codelineno-7-83" href="#__codelineno-7-83"></a><span class="w">  </span><span class="nt">DhcpOptions</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-7-84" name="__codelineno-7-84" href="#__codelineno-7-84"></a><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::DHCPOptions</span><span class="w"></span>
<a id="__codelineno-7-85" name="__codelineno-7-85" href="#__codelineno-7-85"></a><span class="w">      </span><span class="nt">Properties</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-7-86" name="__codelineno-7-86" href="#__codelineno-7-86"></a><span class="w">          </span><span class="nt">DomainName</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;three-tier.org&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-7-87" name="__codelineno-7-87" href="#__codelineno-7-87"></a><span class="w">          </span><span class="nt">DomainNameServers</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-7-88" name="__codelineno-7-88" href="#__codelineno-7-88"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AmazonProvidedDNS</span><span class="w"></span>
<a id="__codelineno-7-89" name="__codelineno-7-89" href="#__codelineno-7-89"></a><span class="w">          </span><span class="nt">Tags</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-7-90" name="__codelineno-7-90" href="#__codelineno-7-90"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-7-91" name="__codelineno-7-91" href="#__codelineno-7-91"></a><span class="w">              </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">Environment</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;three-tier&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;dopt&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-7-92" name="__codelineno-7-92" href="#__codelineno-7-92"></a>
<a id="__codelineno-7-93" name="__codelineno-7-93" href="#__codelineno-7-93"></a><span class="w">  </span><span class="nt">VPCDHCPOptionsAssociation</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-94" name="__codelineno-7-94" href="#__codelineno-7-94"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::VPCDHCPOptionsAssociation</span><span class="w"></span>
<a id="__codelineno-7-95" name="__codelineno-7-95" href="#__codelineno-7-95"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-96" name="__codelineno-7-96" href="#__codelineno-7-96"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">Ref</span><span class="p">:</span><span class="w"> </span><span class="nv">VPC</span><span class="p p-Indicator">}</span><span class="w"></span>
<a id="__codelineno-7-97" name="__codelineno-7-97" href="#__codelineno-7-97"></a><span class="w">      </span><span class="nt">DhcpOptionsId</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">Ref</span><span class="p">:</span><span class="w"> </span><span class="nv">DhcpOptions</span><span class="p p-Indicator">}</span><span class="w"></span>
<a id="__codelineno-7-98" name="__codelineno-7-98" href="#__codelineno-7-98"></a>
<a id="__codelineno-7-99" name="__codelineno-7-99" href="#__codelineno-7-99"></a><span class="w">  </span><span class="nt">InternetGateway</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-100" name="__codelineno-7-100" href="#__codelineno-7-100"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::InternetGateway</span><span class="w"></span>
<a id="__codelineno-7-101" name="__codelineno-7-101" href="#__codelineno-7-101"></a><span class="w">    </span><span class="nt">DependsOn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-7-102" name="__codelineno-7-102" href="#__codelineno-7-102"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-103" name="__codelineno-7-103" href="#__codelineno-7-103"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-104" name="__codelineno-7-104" href="#__codelineno-7-104"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-7-105" name="__codelineno-7-105" href="#__codelineno-7-105"></a><span class="w">        </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">Environment</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;three-tier&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;igw&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-7-106" name="__codelineno-7-106" href="#__codelineno-7-106"></a><span class="w">  </span><span class="nt">VPCGatewayAttachment</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-107" name="__codelineno-7-107" href="#__codelineno-7-107"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::VPCGatewayAttachment</span><span class="w"></span>
<a id="__codelineno-7-108" name="__codelineno-7-108" href="#__codelineno-7-108"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-109" name="__codelineno-7-109" href="#__codelineno-7-109"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-7-110" name="__codelineno-7-110" href="#__codelineno-7-110"></a><span class="w">      </span><span class="nt">InternetGatewayId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">InternetGateway</span><span class="w"></span>
<a id="__codelineno-7-111" name="__codelineno-7-111" href="#__codelineno-7-111"></a>
<a id="__codelineno-7-112" name="__codelineno-7-112" href="#__codelineno-7-112"></a><span class="c1">###############################################</span><span class="w"></span>
<a id="__codelineno-7-113" name="__codelineno-7-113" href="#__codelineno-7-113"></a><span class="c1">### Public/ALB Tier (inbound/outbound)     ####</span><span class="w"></span>
<a id="__codelineno-7-114" name="__codelineno-7-114" href="#__codelineno-7-114"></a><span class="c1">############################################### </span><span class="w"></span>
<a id="__codelineno-7-115" name="__codelineno-7-115" href="#__codelineno-7-115"></a><span class="w">  </span><span class="nt">PublicRouteTableA</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-116" name="__codelineno-7-116" href="#__codelineno-7-116"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::RouteTable</span><span class="w"></span>
<a id="__codelineno-7-117" name="__codelineno-7-117" href="#__codelineno-7-117"></a><span class="w">    </span><span class="nt">DependsOn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPCGatewayAttachment</span><span class="w"></span>
<a id="__codelineno-7-118" name="__codelineno-7-118" href="#__codelineno-7-118"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-119" name="__codelineno-7-119" href="#__codelineno-7-119"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-120" name="__codelineno-7-120" href="#__codelineno-7-120"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-7-121" name="__codelineno-7-121" href="#__codelineno-7-121"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;public&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;rt-1a&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-7-122" name="__codelineno-7-122" href="#__codelineno-7-122"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-7-123" name="__codelineno-7-123" href="#__codelineno-7-123"></a><span class="w">  </span><span class="nt">PublicRouteTableB</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-124" name="__codelineno-7-124" href="#__codelineno-7-124"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::RouteTable</span><span class="w"></span>
<a id="__codelineno-7-125" name="__codelineno-7-125" href="#__codelineno-7-125"></a><span class="w">    </span><span class="nt">DependsOn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPCGatewayAttachment</span><span class="w"></span>
<a id="__codelineno-7-126" name="__codelineno-7-126" href="#__codelineno-7-126"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-127" name="__codelineno-7-127" href="#__codelineno-7-127"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-128" name="__codelineno-7-128" href="#__codelineno-7-128"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-7-129" name="__codelineno-7-129" href="#__codelineno-7-129"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;public&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;rt-1b&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-7-130" name="__codelineno-7-130" href="#__codelineno-7-130"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w">       </span>
<a id="__codelineno-7-131" name="__codelineno-7-131" href="#__codelineno-7-131"></a><span class="c1">###############################################</span><span class="w"></span>
<a id="__codelineno-7-132" name="__codelineno-7-132" href="#__codelineno-7-132"></a><span class="w">  </span><span class="nt">PublicSubnet1</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-133" name="__codelineno-7-133" href="#__codelineno-7-133"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::Subnet</span><span class="w"></span>
<a id="__codelineno-7-134" name="__codelineno-7-134" href="#__codelineno-7-134"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-135" name="__codelineno-7-135" href="#__codelineno-7-135"></a><span class="w">      </span><span class="nt">AvailabilityZone</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!GetAZs</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="p p-Indicator">]</span><span class="w"></span>
<a id="__codelineno-7-136" name="__codelineno-7-136" href="#__codelineno-7-136"></a><span class="w">      </span><span class="nt">CidrBlock</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Cidr</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">CidrBlock1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">Cidr</span><span class="w"> </span><span class="p p-Indicator">]],</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!If</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">CidrBit8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!If</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">CidrBit7</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">7</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">6</span><span class="p p-Indicator">]]]]</span><span class="w"></span>
<a id="__codelineno-7-137" name="__codelineno-7-137" href="#__codelineno-7-137"></a><span class="w">      </span><span class="nt">MapPublicIpOnLaunch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<a id="__codelineno-7-138" name="__codelineno-7-138" href="#__codelineno-7-138"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-139" name="__codelineno-7-139" href="#__codelineno-7-139"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-7-140" name="__codelineno-7-140" href="#__codelineno-7-140"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;public&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;subnet-1a&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-7-141" name="__codelineno-7-141" href="#__codelineno-7-141"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-7-142" name="__codelineno-7-142" href="#__codelineno-7-142"></a><span class="w">  </span><span class="nt">PublicSubnet2</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-143" name="__codelineno-7-143" href="#__codelineno-7-143"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::Subnet</span><span class="w"></span>
<a id="__codelineno-7-144" name="__codelineno-7-144" href="#__codelineno-7-144"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-145" name="__codelineno-7-145" href="#__codelineno-7-145"></a><span class="w">      </span><span class="nt">AvailabilityZone</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!GetAZs</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="p p-Indicator">]</span><span class="w">     </span>
<a id="__codelineno-7-146" name="__codelineno-7-146" href="#__codelineno-7-146"></a><span class="w">      </span><span class="nt">CidrBlock</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Cidr</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">CidrBlock1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">Cidr</span><span class="w"> </span><span class="p p-Indicator">]],</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!If</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">CidrBit8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!If</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">CidrBit7</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">7</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">6</span><span class="p p-Indicator">]]]]</span><span class="w"></span>
<a id="__codelineno-7-147" name="__codelineno-7-147" href="#__codelineno-7-147"></a><span class="w">      </span><span class="nt">MapPublicIpOnLaunch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<a id="__codelineno-7-148" name="__codelineno-7-148" href="#__codelineno-7-148"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-149" name="__codelineno-7-149" href="#__codelineno-7-149"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-7-150" name="__codelineno-7-150" href="#__codelineno-7-150"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;public&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;subnet-1b&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-7-151" name="__codelineno-7-151" href="#__codelineno-7-151"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-7-152" name="__codelineno-7-152" href="#__codelineno-7-152"></a><span class="w">  </span><span class="nt">PublicSubnet3</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-153" name="__codelineno-7-153" href="#__codelineno-7-153"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::Subnet</span><span class="w"></span>
<a id="__codelineno-7-154" name="__codelineno-7-154" href="#__codelineno-7-154"></a><span class="w">    </span><span class="nt">Condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build4AZs</span><span class="w"></span>
<a id="__codelineno-7-155" name="__codelineno-7-155" href="#__codelineno-7-155"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-156" name="__codelineno-7-156" href="#__codelineno-7-156"></a><span class="w">      </span><span class="nt">AvailabilityZone</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!GetAZs</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="p p-Indicator">]</span><span class="w"></span>
<a id="__codelineno-7-157" name="__codelineno-7-157" href="#__codelineno-7-157"></a><span class="w">      </span><span class="nt">CidrBlock</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Cidr</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">CidrBlock1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">Cidr</span><span class="w"> </span><span class="p p-Indicator">]],</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!If</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">CidrBit8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!If</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">CidrBit7</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">7</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">6</span><span class="p p-Indicator">]]]]</span><span class="w"></span>
<a id="__codelineno-7-158" name="__codelineno-7-158" href="#__codelineno-7-158"></a><span class="w">      </span><span class="nt">MapPublicIpOnLaunch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<a id="__codelineno-7-159" name="__codelineno-7-159" href="#__codelineno-7-159"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-160" name="__codelineno-7-160" href="#__codelineno-7-160"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-7-161" name="__codelineno-7-161" href="#__codelineno-7-161"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;public&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;subnet-1c&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-7-162" name="__codelineno-7-162" href="#__codelineno-7-162"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-7-163" name="__codelineno-7-163" href="#__codelineno-7-163"></a><span class="w">  </span><span class="nt">PublicSubnet4</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-164" name="__codelineno-7-164" href="#__codelineno-7-164"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::Subnet</span><span class="w"></span>
<a id="__codelineno-7-165" name="__codelineno-7-165" href="#__codelineno-7-165"></a><span class="w">    </span><span class="nt">Condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build4AZs</span><span class="w"></span>
<a id="__codelineno-7-166" name="__codelineno-7-166" href="#__codelineno-7-166"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-167" name="__codelineno-7-167" href="#__codelineno-7-167"></a><span class="w">      </span><span class="nt">AvailabilityZone</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!GetAZs</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="p p-Indicator">]</span><span class="w">     </span>
<a id="__codelineno-7-168" name="__codelineno-7-168" href="#__codelineno-7-168"></a><span class="w">      </span><span class="nt">CidrBlock</span><span class="p">:</span><span class="w"> </span><span class="kt">!Select</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Cidr</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">CidrBlock1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">Cidr</span><span class="w"> </span><span class="p p-Indicator">]],</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!If</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">CidrBit8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="kt">!If</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">CidrBit7</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">7</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">6</span><span class="p p-Indicator">]]]]</span><span class="w"></span>
<a id="__codelineno-7-169" name="__codelineno-7-169" href="#__codelineno-7-169"></a><span class="w">      </span><span class="nt">MapPublicIpOnLaunch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<a id="__codelineno-7-170" name="__codelineno-7-170" href="#__codelineno-7-170"></a><span class="w">      </span><span class="nt">Tags</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-171" name="__codelineno-7-171" href="#__codelineno-7-171"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="w"></span>
<a id="__codelineno-7-172" name="__codelineno-7-172" href="#__codelineno-7-172"></a><span class="w">          </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!Join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="kt">!Ref</span><span class="w"> </span><span class="nv">ProjectName</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;public&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;subnet-1d&quot;</span><span class="w"> </span><span class="p p-Indicator">]]</span><span class="w"></span>
<a id="__codelineno-7-173" name="__codelineno-7-173" href="#__codelineno-7-173"></a><span class="w">      </span><span class="nt">VpcId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VPC</span><span class="w"></span>
<a id="__codelineno-7-174" name="__codelineno-7-174" href="#__codelineno-7-174"></a><span class="c1">###############################################</span><span class="w"></span>
<a id="__codelineno-7-175" name="__codelineno-7-175" href="#__codelineno-7-175"></a><span class="w">  </span><span class="nt">PublicSubnetAssoc1</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-176" name="__codelineno-7-176" href="#__codelineno-7-176"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::SubnetRouteTableAssociation</span><span class="w"></span>
<a id="__codelineno-7-177" name="__codelineno-7-177" href="#__codelineno-7-177"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-178" name="__codelineno-7-178" href="#__codelineno-7-178"></a><span class="w">      </span><span class="nt">RouteTableId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PublicRouteTableA</span><span class="w"></span>
<a id="__codelineno-7-179" name="__codelineno-7-179" href="#__codelineno-7-179"></a><span class="w">      </span><span class="nt">SubnetId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PublicSubnet1</span><span class="w"></span>
<a id="__codelineno-7-180" name="__codelineno-7-180" href="#__codelineno-7-180"></a><span class="w">  </span><span class="nt">PublicSubnetAssoc2</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-181" name="__codelineno-7-181" href="#__codelineno-7-181"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::SubnetRouteTableAssociation</span><span class="w"></span>
<a id="__codelineno-7-182" name="__codelineno-7-182" href="#__codelineno-7-182"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-183" name="__codelineno-7-183" href="#__codelineno-7-183"></a><span class="w">      </span><span class="nt">RouteTableId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PublicRouteTableB</span><span class="w"></span>
<a id="__codelineno-7-184" name="__codelineno-7-184" href="#__codelineno-7-184"></a><span class="w">      </span><span class="nt">SubnetId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PublicSubnet2</span><span class="w"></span>
<a id="__codelineno-7-185" name="__codelineno-7-185" href="#__codelineno-7-185"></a><span class="w">  </span><span class="nt">PublicSubnetAssoc3</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-186" name="__codelineno-7-186" href="#__codelineno-7-186"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::SubnetRouteTableAssociation</span><span class="w"></span>
<a id="__codelineno-7-187" name="__codelineno-7-187" href="#__codelineno-7-187"></a><span class="w">    </span><span class="nt">Condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build4AZs</span><span class="w"></span>
<a id="__codelineno-7-188" name="__codelineno-7-188" href="#__codelineno-7-188"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-189" name="__codelineno-7-189" href="#__codelineno-7-189"></a><span class="w">      </span><span class="nt">RouteTableId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PublicRouteTableA</span><span class="w"></span>
<a id="__codelineno-7-190" name="__codelineno-7-190" href="#__codelineno-7-190"></a><span class="w">      </span><span class="nt">SubnetId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PublicSubnet3</span><span class="w"></span>
<a id="__codelineno-7-191" name="__codelineno-7-191" href="#__codelineno-7-191"></a><span class="w">  </span><span class="nt">PublicSubnetAssoc4</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-192" name="__codelineno-7-192" href="#__codelineno-7-192"></a><span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::EC2::SubnetRouteTableAssociation</span><span class="w"></span>
<a id="__codelineno-7-193" name="__codelineno-7-193" href="#__codelineno-7-193"></a><span class="w">    </span><span class="nt">Condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build4AZs</span><span class="w"></span>
<a id="__codelineno-7-194" name="__codelineno-7-194" href="#__codelineno-7-194"></a><span class="w">    </span><span class="nt">Properties</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-195" name="__codelineno-7-195" href="#__codelineno-7-195"></a><span class="w">      </span><span class="nt">RouteTableId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PublicRouteTableB</span><span class="w"></span>
<a id="__codelineno-7-196" name="__codelineno-7-196" href="#__codelineno-7-196"></a><span class="w">      </span><span class="nt">SubnetId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PublicSubnet4</span><span class="w"></span>
</code></pre></div>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../ec2-dynamic-dns/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Route53 Dynamic DNS
              </div>
            </div>
          </a>
        
        
          <a href="../../../contact-us/contribute/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Contribute
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright 2022 <a href='https://gtz4all.github.io'>Gtz4All</a>. All Rights Reserved.
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://gtz4all.github.io/" target="_blank" rel="noopener" title="gtz4all.github.io" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8h5z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://github.com/gtz4all" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 002 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0012 2z"/></svg>
      </a>
    
      
      
      <a href="gtz4all@gmail.com" target="_blank" rel="noopener" title="" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 8l-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 002 2h16a2 2 0 002-2V6a2 2 0 00-2-2z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/vendor.18f0862e.min.js"></script>
      <script src="../../../assets/javascripts/bundle.994580cf.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../../..",
          features: ['navigation.tabs', 'navigation.prune'],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>